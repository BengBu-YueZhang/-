<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Elasticsearch," />










<meta name="keywords" content="Elasticsearch">
<meta property="og:type" content="article">
<meta property="og:title" content="Elasticsearchå…¥é—¨ (2)">
<meta property="og:url" content="https://bengbu-yuezhang.github.io/yue.github.io/2018/06/19/Elasticsearch02/index.html">
<meta property="og:site_name" content="æ–°ä¸–ç´€ã‚¨ãƒ´ã‚¡ãƒ³ã‚²ãƒªã‚ªãƒ³">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://unsplash.it/1280/765?random">
<meta property="og:updated_time" content="2018-06-20T22:53:41.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Elasticsearchå…¥é—¨ (2)">
<meta name="twitter:image" content="https://unsplash.it/1280/765?random">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://bengbu-yuezhang.github.io/yue.github.io/2018/06/19/Elasticsearch02/"/>





  <title>Elasticsearchå…¥é—¨ (2) | æ–°ä¸–ç´€ã‚¨ãƒ´ã‚¡ãƒ³ã‚²ãƒªã‚ªãƒ³</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">æ–°ä¸–ç´€ã‚¨ãƒ´ã‚¡ãƒ³ã‚²ãƒªã‚ªãƒ³</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">å‰ç«¯å°å­¦ç”Ÿ</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            ä¸»é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            æ—¶é—´è½´
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://bengbu-yuezhang.github.io/yue.github.io/2018/06/19/Elasticsearch02/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="å¼ è¶Š">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æ–°ä¸–ç´€ã‚¨ãƒ´ã‚¡ãƒ³ã‚²ãƒªã‚ªãƒ³">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Elasticsearchå…¥é—¨ (2)</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-19T22:15:51+08:00">
                2018-06-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="https://unsplash.it/1280/765?random" alt="image"></p>
<a id="more"></a>
<h1 id="å¯¼å…¥"><a href="#å¯¼å…¥" class="headerlink" title="å¯¼å…¥"></a>å¯¼å…¥</h1><p>ä½¿ç”¨<a href="https://github.com/taskrabbit/elasticsearch-dump" target="_blank" rel="noopener">elasticsearch-dump</a>å¯¼å…¥æ–‡ä»¶æ•°æ®åˆ°Esä¸­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// dumpçš„ä½¿ç”¨æ–¹æ³•</span></span><br><span class="line">elasticdump \</span><br><span class="line">  <span class="comment">// JSONæ–‡ä»¶è·¯å¾„</span></span><br><span class="line">  --input=<span class="regexp">/Users/</span>zhangyue/Documents/swmgame-activity<span class="number">-2018.06</span>/swmgame-activity<span class="number">-2018.06</span>.mapping.json \</span><br><span class="line">  <span class="comment">// å¯¼å…¥çš„è·¯å¾„</span></span><br><span class="line">  --output=http:<span class="comment">//127.0.0.1:9200/my_index_type \</span></span><br><span class="line">  --type=mapping</span><br><span class="line">elasticdump \</span><br><span class="line">  --input=<span class="regexp">/Users/</span>zhangyue/Documents/swmgame-activity<span class="number">-2018.06</span>/swmgame-activity<span class="number">-2018.06</span>.data.json \</span><br><span class="line">  --output=http:<span class="comment">//127.0.0.1:9200/my_index_type \</span></span><br><span class="line">  --type=data</span><br></pre></td></tr></table></figure>
<h1 id="æœç´¢"><a href="#æœç´¢" class="headerlink" title="æœç´¢"></a>æœç´¢</h1><h2 id="ç²¾ç¡®å€¼æœç´¢"><a href="#ç²¾ç¡®å€¼æœç´¢" class="headerlink" title="ç²¾ç¡®å€¼æœç´¢"></a>ç²¾ç¡®å€¼æœç´¢</h2><h3 id="termæŸ¥è¯¢æ•°å­—"><a href="#termæŸ¥è¯¢æ•°å­—" class="headerlink" title="termæŸ¥è¯¢æ•°å­—"></a>termæŸ¥è¯¢æ•°å­—</h3><p>termæŸ¥è¯¢ä¼šæŸ¥æ‰¾æŒ‡å®šçš„ç²¾ç¡®å€¼, å¦‚æœä¸æƒ³è®¡ç®—ç›¸å…³åº¦ç®—åˆ†, å¯ä»¥ä½¿ç”¨filterå¯ä»¥æ›´å¿«çš„æ‰§è¡Œæ“ä½œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// æ£€ç´¢passStatusä¸º2çš„æ–‡æ¡£</span></span><br><span class="line"></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"must"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"term"</span>: &#123;</span><br><span class="line">            <span class="string">"passStatus"</span>: &#123;</span><br><span class="line">              <span class="string">"value"</span>: <span class="number">2</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ£€ç´¢passStatusç­‰äº2å¹¶ä¸”gameIdç­‰äºG09, å¹¶ä¸”æŸ¥è¯¢ä¸è®¡ç®—ç›¸å…³åº¦ç®—åˆ†</span></span><br><span class="line"></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="comment">// ä¸è®¡ç®—ç›¸å…³åº¦ç®—åˆ†</span></span><br><span class="line">      <span class="string">"filter"</span>: &#123;</span><br><span class="line">        <span class="string">"bool"</span>: &#123;</span><br><span class="line">          <span class="string">"must"</span>: [</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="string">"term"</span>: &#123;</span><br><span class="line">                <span class="string">"passStatus"</span>: &#123;</span><br><span class="line">                  <span class="string">"value"</span>: <span class="number">2</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="string">"term"</span>: &#123;</span><br><span class="line">                <span class="string">"gameId.keyword"</span>: &#123;</span><br><span class="line">                  <span class="string">"value"</span>: <span class="string">"G09"</span></span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="termæŸ¥è¯¢æ–‡æœ¬"><a href="#termæŸ¥è¯¢æ–‡æœ¬" class="headerlink" title="termæŸ¥è¯¢æ–‡æœ¬"></a>termæŸ¥è¯¢æ–‡æœ¬</h3><p>ğŸ˜” ä½¿ç”¨termæ£€ç´¢æ–‡æœ¬çš„æ—¶å€™, æ£€ç´¢çš„ç»“æœå¯èƒ½ä¸æˆ‘ä»¬é¢„æœŸçš„ç»“æœå¹¶ä¸ä¸€è‡´, è¿™æ˜¯ä»€ä¹ˆåŸå› å¯¼è‡´çš„å‘¢? </p>
<p>ğŸ’¡ æˆ‘ä»¬é€šè¿‡analyzeAPIå¯ä»¥çœ‹åˆ°, æ–‡æ¡£ä¸­çš„textç±»å‹çš„å­—æ®µ, å·²ç»è¢«åˆ†è¯ã€‚å¦‚æœä½¿ç”¨termç²¾ç¡®æŸ¥æ‰¾å…¨æ–‡, æ˜¯ä¸ä¼šåŒ¹é…åˆ°æ•°æ®çš„ã€‚å› ä¸ºè¿™äº›å…¨æ–‡å¹¶æ²¡æœ‰è¢«å­˜å‚¨åœ¨å€’æ’ç´¢å¼•ä¸­ã€‚</p>
<p>ğŸ“– æœ‰ä¸¤ç§è§£å†³çš„åŠæ³•, è§£å†³åŠæ³•1, åœ¨esä¸­esé»˜è®¤ä¼šä¸ºå­—æ®µåˆ›å»ºåä¸ºkeywordçš„keywordç±»å‹çš„fieldså­—æ®µ, äºå­—æ®µä¸€è‡´ä½†æ˜¯ç±»å‹å¹¶ä¸ä¸€è‡´ã€‚å¯ä»¥ä½¿ç”¨keywordçš„fieldså­—æ®µè¿›è¡ŒtermæŸ¥è¯¢ã€‚è§£å†³åŠæ³•2, åˆ›å»ºæ–°çš„ç´¢å¼•ä½¿ç”¨æ–°çš„mapping, æŒ‡å®šå­—æ®µä¸ºkeywordç±»å‹</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// è§£å†³åŠæ³•1</span></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"must"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"term"</span>: &#123;</span><br><span class="line">            <span class="string">"gameId.keyword"</span>: &#123;</span><br><span class="line">              <span class="string">"value"</span>: <span class="string">"G09"</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// è§£å†³åŠæ³•2</span></span><br><span class="line">DELETE test5_index</span><br><span class="line">PUT test5_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"mappings"</span>: &#123;</span><br><span class="line">    <span class="string">"doc"</span>: &#123;</span><br><span class="line">      <span class="string">"properties"</span>: &#123;</span><br><span class="line">        <span class="string">"gameId"</span>: &#123;</span><br><span class="line">          <span class="string">"type"</span>: <span class="string">"keyword"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="termæŸ¥è¯¢èŒƒå›´ç±»å‹"><a href="#termæŸ¥è¯¢èŒƒå›´ç±»å‹" class="headerlink" title="termæŸ¥è¯¢èŒƒå›´ç±»å‹"></a>termæŸ¥è¯¢èŒƒå›´ç±»å‹</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">DELETE test_index</span><br><span class="line">PUT test_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"mappings"</span>: &#123;</span><br><span class="line">    <span class="string">"doc"</span>: &#123;</span><br><span class="line">      <span class="string">"properties"</span>: &#123;</span><br><span class="line">        <span class="comment">// å®šä¹‰ageå­—æ®µä¸ºèŒƒå›´ç±»å‹</span></span><br><span class="line">        <span class="string">"age"</span>: &#123;</span><br><span class="line">          <span class="string">"type"</span>: <span class="string">"integer_range"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ æµ‹è¯•æ•°æ®</span></span><br><span class="line">POST test_index/doc/_bulk</span><br><span class="line">&#123;<span class="string">"index"</span>:&#123;<span class="string">"_id"</span>:<span class="number">1</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"age"</span>:&#123;<span class="string">"gte"</span>:<span class="number">10</span>,<span class="string">"lte"</span>:<span class="number">20</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"index"</span>:&#123;<span class="string">"_id"</span>:<span class="number">2</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"age"</span>:&#123;<span class="string">"gte"</span>:<span class="number">21</span>,<span class="string">"lte"</span>:<span class="number">30</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢æ–‡æ¡£</span></span><br><span class="line">GET test_index/doc/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"term"</span>: &#123;</span><br><span class="line">      <span class="string">"age"</span>: &#123;</span><br><span class="line">        <span class="string">"value"</span>: <span class="number">11</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç»„åˆè¿‡æ»¤å™¨"><a href="#ç»„åˆè¿‡æ»¤å™¨" class="headerlink" title="ç»„åˆè¿‡æ»¤å™¨"></a>ç»„åˆè¿‡æ»¤å™¨</h2><p>ç»„ä»¶è¿‡æ»¤å™¨çš„ç»„æˆ:</p>
<ol>
<li>must å¿…é¡»æ»¡è¶³çš„ä¸€ç»„æ¡ä»¶</li>
<li>must_not å¿…é¡»ä¸æ»¡è¶³çš„ä¸€ç»„æ¡ä»¶</li>
<li>should å¯ä»¥æ»¡è¶³çš„ä¸€ç»„çš„æ¡ä»¶, å¦‚æœæ»¡è¶³å¯ä»¥å¢åŠ ç›¸å…³æ€§ç®—åˆ†(å¦‚æœç»„åˆè¿‡æ»¤å™¨ä¸­åªæœ‰should, åˆ™æ–‡æ¡£å¿…é¡»æ»¡è¶³shouldä¸­çš„ä¸€é¡¹æ¡ä»¶)</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// åµŒå¥—çš„boolæŸ¥è¯¢</span></span><br><span class="line"><span class="comment">// æ£€ç´¢gameIdç­‰äºG09, æˆ–è€…passStatusç­‰äº2å¹¶ä¸”sourceç­‰äºios</span></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"should"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"term"</span>: &#123;</span><br><span class="line">            <span class="string">"gameId.keyword"</span>: &#123;</span><br><span class="line">              <span class="string">"value"</span>: <span class="string">"G09"</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"bool"</span>: &#123;</span><br><span class="line">            <span class="string">"must"</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="string">"term"</span>: &#123;</span><br><span class="line">                  <span class="string">"passStatus"</span>: &#123;</span><br><span class="line">                    <span class="string">"value"</span>: <span class="string">"2"</span></span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;,</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="string">"term"</span>: &#123;</span><br><span class="line">                  <span class="string">"source.keyword"</span>: &#123;</span><br><span class="line">                    <span class="string">"value"</span>: <span class="string">"ios"</span></span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;</span><br><span class="line">              &#125;</span><br><span class="line">            ]</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="terms"><a href="#terms" class="headerlink" title="terms"></a>terms</h2><p>termsæŸ¥è¯¢ä¸termæŸ¥è¯¢ç±»ä¼¼ï¼ŒtermsåŒ¹é…çš„æ˜¯ä¸€ç»„ç²¾ç¡®å€¼, æ˜¯ä¸€ä¸ªç²¾ç¡®å€¼æ•°ç»„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// termsåŒ¹é…çš„æ˜¯ä¸€ç»„æ•°ç»„</span></span><br><span class="line"><span class="comment">// æ£€ç´¢passStatusä¸º1æˆ–è€…2çš„æ–‡æ¡£</span></span><br><span class="line"></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"filter"</span>: &#123;</span><br><span class="line">        <span class="string">"terms"</span>: &#123;</span><br><span class="line">          <span class="string">"passStatus"</span>: [</span><br><span class="line">            <span class="number">1</span>,<span class="number">2</span></span><br><span class="line">          ]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="range"><a href="#range" class="headerlink" title="range"></a>range</h2><ul>
<li>gt å¤§äº</li>
<li>gte å¤§äºç­‰äº</li>
<li>lt å°äº</li>
<li>lte å°äºç­‰äº</li>
</ul>
<h3 id="æ•°å­—èŒƒå›´æŸ¥è¯¢-ğŸ”¢"><a href="#æ•°å­—èŒƒå›´æŸ¥è¯¢-ğŸ”¢" class="headerlink" title="æ•°å­—èŒƒå›´æŸ¥è¯¢ ğŸ”¢"></a>æ•°å­—èŒƒå›´æŸ¥è¯¢ ğŸ”¢</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// passStatuså¤§äºç­‰äº1å¹¶ä¸”å°äº2çš„æ–‡æ¡£</span></span><br><span class="line"></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"filter"</span>: &#123;</span><br><span class="line">        <span class="string">"range"</span>: &#123;</span><br><span class="line">          <span class="string">"passStatus"</span>: &#123;</span><br><span class="line">            <span class="string">"gte"</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="string">"lt"</span>: <span class="number">2</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æ—¥æœŸèŒƒå›´æŸ¥è¯¢-ğŸ“…"><a href="#æ—¥æœŸèŒƒå›´æŸ¥è¯¢-ğŸ“…" class="headerlink" title="æ—¥æœŸèŒƒå›´æŸ¥è¯¢ ğŸ“…"></a>æ—¥æœŸèŒƒå›´æŸ¥è¯¢ ğŸ“…</h3><p>åœ¨ä½¿ç”¨æ—¥æœŸèŒƒå›´æŸ¥è¯¢çš„æ—¶å€™ï¼Œéœ€è¦é¢„å…ˆå°†æ—¥æœŸçš„å­—æ®µçš„mappingçš„typeç±»å‹è®¾ç½®ä¸ºdate</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">DELETE test_index</span><br><span class="line">PUT test_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"mappings"</span>: &#123;</span><br><span class="line">    <span class="string">"doc"</span>: &#123;</span><br><span class="line">      <span class="string">"properties"</span>: &#123;</span><br><span class="line">        <span class="comment">// è®¾ç½®ä¸ºtimeç±»å‹</span></span><br><span class="line">        <span class="string">"time"</span>: &#123;</span><br><span class="line">          <span class="string">"type"</span>: <span class="string">"date"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ·»åŠ æµ‹è¯•æ•°æ®</span></span><br><span class="line">POST test_index/doc/_bulk</span><br><span class="line">&#123;<span class="string">"index"</span>:&#123;<span class="string">"_id"</span>:<span class="number">1</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"time"</span>:<span class="string">"1994-06-07"</span>&#125;</span><br><span class="line">&#123;<span class="string">"index"</span>:&#123;<span class="string">"_id"</span>:<span class="number">2</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"time"</span>:<span class="string">"1994-10-22"</span>&#125;</span><br><span class="line">&#123;<span class="string">"index"</span>:&#123;<span class="string">"_id"</span>:<span class="number">3</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"time"</span>:<span class="string">"1993-07-01"</span>&#125;</span><br><span class="line">&#123;<span class="string">"index"</span>:&#123;<span class="string">"_id"</span>:<span class="number">4</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"time"</span>:<span class="string">"2005-01-01"</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢æ–‡æ¡£çš„timeå­—æ®µçš„æ—¥æœŸèŒƒå›´æ˜¯å¤§äº1994-10-22, å°äºç­‰äº2005-01-01</span></span><br><span class="line">GET test6_index/doc/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"filter"</span>: &#123;</span><br><span class="line">        <span class="string">"range"</span>: &#123;</span><br><span class="line">          <span class="string">"time"</span>: &#123;</span><br><span class="line">            <span class="string">"gt"</span>: <span class="string">"1994-10-22"</span>,</span><br><span class="line">            <span class="string">"lte"</span>: <span class="string">"2005-01-01"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å­—ç¬¦ä¸²èŒƒå›´æŸ¥è¯¢-ğŸ“–"><a href="#å­—ç¬¦ä¸²èŒƒå›´æŸ¥è¯¢-ğŸ“–" class="headerlink" title="å­—ç¬¦ä¸²èŒƒå›´æŸ¥è¯¢ ğŸ“–"></a>å­—ç¬¦ä¸²èŒƒå›´æŸ¥è¯¢ ğŸ“–</h3><p>å­—ç¬¦ä¸²èŒƒå›´ä½¿ç”¨çš„æ˜¯å­—å…¸é¡ºåº(lexicographically)çš„æ’åºæ–¹å¼ã€‚</p>
<p>ğŸ  ä»€ä¹ˆæ˜¯å­—å…¸åº?</p>
<p>æ¯”å¦‚è¯´æœ‰ä¸€ä¸ªéšæœºå˜é‡XåŒ…å«1, 2, 3ä¸‰ä¸ªæ•°å€¼ã€‚</p>
<p>å…¶å­—å…¸æ’åºå°±æ˜¯123 132 213 231 312 321</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">DELETE test_index</span><br><span class="line"><span class="comment">// æ·»åŠ æµ‹è¯•æ•°æ®</span></span><br><span class="line">POST test_index/doc/_bulk</span><br><span class="line">&#123;<span class="string">"index"</span>:&#123;<span class="string">"_id"</span>:<span class="number">1</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"name"</span>:<span class="string">"abce fg"</span>&#125;</span><br><span class="line">&#123;<span class="string">"index"</span>:&#123;<span class="string">"_id"</span>:<span class="number">2</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"name"</span>:<span class="string">"cba twa"</span>&#125;</span><br><span class="line">&#123;<span class="string">"index"</span>:&#123;<span class="string">"_id"</span>:<span class="number">3</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"name"</span>:<span class="string">"a cb"</span>&#125;</span><br><span class="line">&#123;<span class="string">"index"</span>:&#123;<span class="string">"_id"</span>:<span class="number">4</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"name"</span>:<span class="string">"gfw wfw"</span>&#125;</span><br><span class="line">&#123;<span class="string">"index"</span>:&#123;<span class="string">"_id"</span>:<span class="number">5</span>&#125;&#125;</span><br><span class="line">&#123;<span class="string">"name"</span>:<span class="string">"bgfw wfw"</span>&#125;</span><br><span class="line"></span><br><span class="line">GET test_index/doc/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"filter"</span>: &#123;</span><br><span class="line">        <span class="string">"range"</span>: &#123;</span><br><span class="line">          <span class="string">"name"</span>: &#123;</span><br><span class="line">            <span class="string">"gte"</span>: <span class="string">"a"</span>,</span><br><span class="line">            <span class="string">"lt"</span>: <span class="string">"c"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å¤„ç†Nullå€¼"><a href="#å¤„ç†Nullå€¼" class="headerlink" title="å¤„ç†Nullå€¼"></a>å¤„ç†Nullå€¼</h2><h3 id="å­˜åœ¨æŸ¥è¯¢"><a href="#å­˜åœ¨æŸ¥è¯¢" class="headerlink" title="å­˜åœ¨æŸ¥è¯¢"></a>å­˜åœ¨æŸ¥è¯¢</h3><p>æ£€ç´¢æ–‡æ¡£ä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªéç©ºçš„æ–‡æ¡£ã€‚(ğŸ¶å…¨éƒ¨ä¸ºç©ºæˆ–è€…æ²¡æœ‰è¯¥å­—æ®µçš„é™¤å¤–)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥æ‰¾gameå­—æ®µè‡³å°‘åŒ…å«ä¸€ä¸ªéç©ºæ–‡æ¡£çš„æ–‡æ¡£</span></span><br><span class="line">GET test_index/doc/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"exists"</span>: &#123;</span><br><span class="line">      <span class="string">"field"</span>: <span class="string">"game"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="ç¼ºå¤±æŸ¥è¯¢"><a href="#ç¼ºå¤±æŸ¥è¯¢" class="headerlink" title="ç¼ºå¤±æŸ¥è¯¢"></a>ç¼ºå¤±æŸ¥è¯¢</h3><p>æŸ¥è¯¢æ–‡æ¡£ä¸­ä¸ºnull, æˆ–è€…æ²¡æœ‰è¯¥å­—æ®µçš„æ–‡æ¡£</p>
<p>ğŸ’¡ ç¼ºå¤±æŸ¥è¯¢å·²ç»åœ¨ElasticSearch2.2.0ä¸­åºŸå¼ƒã€‚å¯ä»¥ä½¿ç”¨ä»¥ä¸‹çš„æ–¹æ³•ä»£æ›¿</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GET test_index/doc/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"must_not"</span>: &#123;</span><br><span class="line">        <span class="string">"exists"</span>: &#123;</span><br><span class="line">          <span class="string">"field"</span>: <span class="string">"game"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å…¨æ–‡æœç´¢"><a href="#å…¨æ–‡æœç´¢" class="headerlink" title="å…¨æ–‡æœç´¢"></a>å…¨æ–‡æœç´¢</h2><h3 id="åŸºæœ¬æ¦‚å¿µ"><a href="#åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="åŸºæœ¬æ¦‚å¿µ"></a>åŸºæœ¬æ¦‚å¿µ</h3><h4 id="åŸºäºè¯é¡¹"><a href="#åŸºäºè¯é¡¹" class="headerlink" title="åŸºäºè¯é¡¹"></a>åŸºäºè¯é¡¹</h4><p>å¦‚termæŸ¥è¯¢ä¸ä¼šç»è¿‡åˆ†æé˜¶æ®µï¼Œåªä¼šåœ¨å€’æ’ç´¢å¼•ä¸­æŸ¥æ‰¾ç²¾ç¡®çš„è¯é¡¹ï¼Œå¹¶ç”¨TF/DFç®—æ³•ä¸ºæ–‡æ¡£è¿›è¡Œç›¸å…³æ€§è¯„åˆ†_scoreã€‚termæŸ¥è¯¢åªå¯¹å€’æ’ç´¢å¼•çš„è¯é¡¹ç²¾ç¡®åŒ¹é…ï¼Œè€Œä¸ä¼šå¯¹æŸ¥è¯¢è¯è¿›è¡Œå¤šæ ·æ€§å¤„ç†ã€‚</p>
<h4 id="åŸºäºå…¨æ–‡"><a href="#åŸºäºå…¨æ–‡" class="headerlink" title="åŸºäºå…¨æ–‡"></a>åŸºäºå…¨æ–‡</h4><p>å¦‚matchæŸ¥è¯¢å’Œquery_stringæŸ¥è¯¢ã€‚å¯¹äºæ—¥æœŸå’Œæ•´æ•°ä¼šå°†æŸ¥è¯¢å­—ç¬¦ä¸²å½“ä½œæ•´æ•°å¯¹å¾…ã€‚å¦‚æœæŸ¥è¯¢çš„æ˜¯keywordç±»å‹çš„å­—æ®µï¼Œä¼šå°†æŸ¥è¯¢å­—ç¬¦ä¸²å½“ä½œå•ä¸ªå•è¯å¯¹å¾…ã€‚å¦‚æœæ˜¯å…¨æ–‡å­—æ®µï¼Œä¼šå°†æŸ¥è¯¢å­—ç¬¦ä¸²ä½¿ç”¨åˆé€‚çš„åˆ†æå™¨ï¼Œä½œå‡ºå¤„ç†ï¼Œç”Ÿæˆä¸€ä¸ªæŸ¥è¯¢è¯é¡¹çš„åˆ—è¡¨ï¼ŒæŸ¥è¯¢ä¼šå¯¹è¯é¡¹åˆ—è¡¨ä¸­çš„æ¯ä¸€é¡¹è¿›è¡ŒæŸ¥è¯¢ï¼Œå†å°†ç»“æœè¿›è¡Œåˆå¹¶ã€‚</p>
<h2 id="åŒ¹é…æŸ¥è¯¢"><a href="#åŒ¹é…æŸ¥è¯¢" class="headerlink" title="åŒ¹é…æŸ¥è¯¢"></a>åŒ¹é…æŸ¥è¯¢</h2><p>matchæŸ¥è¯¢å³å¯ä»¥è¿›è¡Œç²¾ç¡®æ£€ç´¢ä¹Ÿå¯ä»¥è¿›è¡Œå…¨æ–‡æ£€ç´¢ï¼Œä»¥ä¸‹æ˜¯matchæŸ¥è¯¢çš„å…·ä½“çš„è¿‡ç¨‹:</p>
<ol>
<li>æ£€æŸ¥å­—æ®µç±»å‹, å¦‚æœæ£€ç´¢çš„å­—æ®µæ˜¯textç±»å‹, é‚£ä¹ˆæŸ¥è¯¢å­—ç¬¦ä¸²ä¹Ÿåº”å½“è¢«åˆ†æ</li>
<li>åˆ†ææŸ¥è¯¢å­—ç¬¦ä¸², å°†æŸ¥è¯¢å­—ç¬¦ä¸²ç»è¿‡é»˜è®¤çš„åˆ†æå™¨çš„å¤„ç†, matchæ‰§è¡Œçš„æ˜¯å½“ä¸ªåº•å±‚çš„termæŸ¥è¯¢</li>
<li>termæŸ¥è¯¢ä¼šåœ¨å€’æ’ç´¢å¼•ä¸­å¯¹åˆ†æåçš„æŸ¥è¯¢å­—ç¬¦ä¸²è¿›è¡Œæ£€ç´¢</li>
<li>ä¸ºåŒ¹é…çš„æ–‡æ¡£è¯„åˆ†(æ£€ç´¢è¯é¢‘ç‡, åå‘æ–‡æ¡£é¢‘ç‡, å­—æ®µé•¿åº¦å‡†åˆ™)</li>
<li>ä¸ºä»€ä¹ˆåœ¨è¿™é‡Œæµ‹è¯•åªåˆ›å»ºä¸€ä¸ªåˆ†ç‰‡, åé¢ä¼šæœ‰ä»‹ç»</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// åªåˆ›å»ºä¸€ä¸ªä¸»åˆ†ç‰‡</span></span><br><span class="line">PUT /swmgame-activity<span class="number">-2018.06</span></span><br><span class="line">&#123; <span class="string">"settings"</span>: &#123; <span class="string">"number_of_shards"</span>: <span class="number">1</span> &#125;&#125; </span><br><span class="line"></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"filter"</span>: &#123;</span><br><span class="line">        <span class="string">"match"</span>: &#123;</span><br><span class="line">          <span class="string">"ipInfo.city"</span>: <span class="string">"èšŒåŸ "</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125; </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="å¤šè¯æŸ¥è¯¢"><a href="#å¤šè¯æŸ¥è¯¢" class="headerlink" title="å¤šè¯æŸ¥è¯¢"></a>å¤šè¯æŸ¥è¯¢</h2><p>matchæŸ¥è¯¢å¦‚æœæŸ¥è¯¢çš„æ˜¯textç±»å‹çš„å…¨æ–‡å­—æ®µ, é‚£ä¹ˆä¹Ÿä¼šå¯¹æŸ¥è¯¢å­—ç¬¦ä¸²è¿›è¡Œåˆ†æ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// matchæŸ¥è¯¢ä¼šåˆ†åˆ«æŸ¥è¯¢èšŒåŸ å’Œé¾™å­æ¹–åŒºä¸¤ä¸ªå­—æ®µ</span></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"filter"</span>: &#123;</span><br><span class="line">        <span class="string">"match"</span>: &#123;</span><br><span class="line">          <span class="string">"ipInfo.city"</span>: <span class="string">"èšŒåŸ  é¾™å­æ¹–åŒº"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125; </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¦‚æœå¸Œæœ›æŸ¥è¯¢çš„æ–‡æ¡£, åŒæ—¶åŒ…å«æ‰€æœ‰çš„å…³é”®è¯, åˆ™å¯ä»¥ä½¿ç”¨operatorä½¿ç”¨andæ“ä½œç¬¦</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢åŒ…å«èšŒåŸ å¹¶ä¸”åŒ…å«é¾™å­æ¹–åŒºä¸¤ä¸ªå­—æ®µ</span></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"filter"</span>: &#123;</span><br><span class="line">        <span class="string">"match"</span>: &#123;</span><br><span class="line">          <span class="string">"ipInfo.city"</span>: <span class="string">"èšŒåŸ  é¾™å­æ¹–åŒº"</span>,</span><br><span class="line">          <span class="string">"operator"</span>: <span class="string">"and"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125; </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="æœ€å°åŒ¹é…æ•°"><a href="#æœ€å°åŒ¹é…æ•°" class="headerlink" title="æœ€å°åŒ¹é…æ•°"></a>æœ€å°åŒ¹é…æ•°</h3><p>matchæŸ¥è¯¢å¯ä»¥è®¾ç½®minimum_should_matchå‚æ•°ï¼Œå³æœ€å°åŒ¹é…æ•°ï¼Œå¦‚æœmatchæŸ¥è¯¢æœ‰å››ä¸ªè¯é¡¹ï¼Œå¦‚æœminimum_should_matchè®¾ç½®ä¸º50%ï¼Œé‚£ä¹ˆæœ€å°‘åŒ¹é…2ä¸ªè¯é¡¹</p>
<h2 id="ç»„åˆæŸ¥è¯¢"><a href="#ç»„åˆæŸ¥è¯¢" class="headerlink" title="ç»„åˆæŸ¥è¯¢"></a>ç»„åˆæŸ¥è¯¢</h2><p>ç»„åˆæŸ¥è¯¢æ¥å—must, must_not, shouldã€‚å¦‚æœå½“DSLä¸­åªåŒ…å«shouldçš„æ—¶å€™, shouldè‡³å°‘æœ‰ä¸€ä¸ªå¿…é¡»åŒ¹é…ã€‚åŒæ—¶å¯ä»¥æŒ‡å®šshouldçš„minimum_should_matchå‚æ•°, æ§åˆ¶æŸ¥è¯¢çš„ç²¾åº¦ã€‚æ§åˆ¶å¿…é¡»åŒ¹é…çš„æ•°é‡ã€‚</p>
<p>å¤šè¯æŸ¥è¯¢ä¸­, ä½¿ç”¨oræ“ä½œç¬¦å·, å’Œä½¿ç”¨shouldæŸ¥è¯¢æ˜¯ç­‰ä»·çš„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// ä¸¤æ¡æŸ¥è¯¢æ˜¯ç­‰ä»·çš„</span></span><br><span class="line">GET test_index/doc/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"match"</span>: &#123;</span><br><span class="line">      <span class="string">"title"</span>: <span class="string">"fox dog"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GET test_index/doc/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"should"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"term"</span>: &#123;</span><br><span class="line">            <span class="string">"title"</span>: &#123;</span><br><span class="line">              <span class="string">"value"</span>: <span class="string">"fox"</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"term"</span>: &#123;</span><br><span class="line">            <span class="string">"title"</span>: &#123;</span><br><span class="line">              <span class="string">"value"</span>: <span class="string">"dog"</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¤šè¯æŸ¥è¯¢ä¸­, ä½¿ç”¨andæ“ä½œç¬¦, å’Œä½¿ç”¨mustæŸ¥è¯¢æ˜¯ç­‰ä»·çš„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// ä¸¤æ¡æŸ¥è¯¢æ˜¯ç­‰ä»·çš„</span></span><br><span class="line"></span><br><span class="line">GET test_index/doc/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"match"</span>: &#123;</span><br><span class="line">      <span class="string">"title"</span>: &#123;</span><br><span class="line">        <span class="string">"query"</span>: <span class="string">"fox dog"</span>,</span><br><span class="line">        <span class="string">"operator"</span>: <span class="string">"and"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">GET test_index/doc/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"must"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"term"</span>: &#123;</span><br><span class="line">            <span class="string">"title"</span>: &#123;</span><br><span class="line">              <span class="string">"value"</span>: <span class="string">"fox"</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"term"</span>: &#123;</span><br><span class="line">            <span class="string">"title"</span>: &#123;</span><br><span class="line">              <span class="string">"value"</span>: <span class="string">"dog"</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="æƒé‡"><a href="#æƒé‡" class="headerlink" title="æƒé‡"></a>æƒé‡</h2><p>è®¾ç½®boostå¯ä»¥è®¾ç½®æŸ¥è¯¢è¯­å¥çš„æƒé‡, å¤§äº1æƒé‡å¢å¤§, 0åˆ°1ä¹‹é—´æƒé‡é€æ¸é™ä½ã€‚åŒ¹é…åˆ°æƒé‡è¶Šé«˜çš„æŸ¥è¯¢è¯­å¥, ç›¸å…³æ€§ç®—åˆ†è¶Šé«˜</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// å®‰å¾½çš„æŸ¥è¯¢è¯­å¥çš„æƒé‡ä¸º3, åŒ¹é…åˆ°çš„æ–‡æ¡£çš„å¾—åˆ†æ›´é«˜</span></span><br><span class="line"></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"should"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"term"</span>: &#123;</span><br><span class="line">            <span class="string">"passStatus"</span>: &#123;</span><br><span class="line">              <span class="string">"value"</span>: <span class="number">2</span>,</span><br><span class="line">              <span class="string">"boost"</span>: <span class="number">2</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125; </span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"match"</span>: &#123;</span><br><span class="line">            <span class="string">"ipInfo.province.keyword"</span>: &#123;</span><br><span class="line">              <span class="string">"query"</span>: <span class="string">"å®‰å¾½"</span>,</span><br><span class="line">              <span class="string">"boost"</span>: <span class="number">3</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="é»˜è®¤çš„åˆ†æå™¨"><a href="#é»˜è®¤çš„åˆ†æå™¨" class="headerlink" title="é»˜è®¤çš„åˆ†æå™¨"></a>é»˜è®¤çš„åˆ†æå™¨</h2><p>ç´¢å¼•æ—¶çš„åˆ†æå™¨:</p>
<ol>
<li>é¦–å…ˆä½¿ç”¨å­—æ®µæ˜ å°„çš„åˆ†æå™¨</li>
<li>å…¶æ¬¡æ˜¯indexé»˜è®¤çš„åˆ†æå™¨</li>
<li>æœ€åæ˜¯é»˜è®¤ä¸ºstandardåˆ†æå™¨</li>
</ol>
<p>æœç´¢æ—¶çš„åˆ†æå™¨: </p>
<ol>
<li>ä¼˜å…ˆæŸ¥æ‰¾å®šä¹‰çš„åˆ†æå™¨</li>
<li>å…¶æ¬¡æ˜¯å­—æ®µæ˜ å°„çš„åˆ†æå™¨</li>
<li>æœ€åæ˜¯ç´¢å¼•é»˜è®¤çš„defaultçš„åˆ†æå™¨, é»˜è®¤ä¸ºstandardåˆ†æå™¨</li>
</ol>
<h2 id="ç›¸å…³åº¦è¢«ç ´å"><a href="#ç›¸å…³åº¦è¢«ç ´å" class="headerlink" title="ç›¸å…³åº¦è¢«ç ´å"></a>ç›¸å…³åº¦è¢«ç ´å</h2><p>Q: ä¸ºä»€ä¹ˆåœ¨ä¹‹å‰çš„æµ‹è¯•ç´¢å¼•æ—¶ï¼Œéœ€è¦æŒ‡å®šåªä¸ºè¿™ä¸ªç´¢å¼•åˆ›å»ºä¸€ä¸ªä¸»åˆ†ç‰‡ï¼Ÿ</p>
<p>A: ä¸ºäº†é¿å…ç›¸å…³åº¦è¢«ç ´åã€‚åœ¨elasticsearchä¸­è®¡ç®—ç›¸å…³åº¦ä½¿ç”¨TF/IDFç®—æ³•ï¼Œè¯é¢‘/é€†å‘æ–‡æ¡£è¯é¢‘çš„ç®—æ³•ã€‚å¦‚æœæœ‰5ä¸ªåŒ…å«â€foxâ€çš„æ–‡æ¡£ä½äºåˆ†ç‰‡1ï¼Œä¸€ä¸ªåŒ…å«â€œfoxâ€çš„æ–‡æ¡£ä½äºåˆ†ç‰‡2ã€‚å°±ä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜, foxåœ¨åˆ†ç‰‡1çš„ç›¸å…³åº¦ä¼šé™ä½, è€Œåœ¨åˆ†ç‰‡2çš„ç›¸å…³åº¦å°±ä¼šéå¸¸é«˜ã€‚ä½†æ˜¯åœ¨å®é™…çš„åœºæ™¯ä¸­è¿™å¹¶ä¸æ˜¯ä¸€ä¸ªé—®é¢˜ï¼Œå› ä¸ºåœ¨çœŸå®çš„ç¯å¢ƒä¸­ï¼Œæ•°æ®é‡é€šå¸¸æ˜¯éå¸¸å¤§çš„ï¼Œåˆ†ç‰‡ä¹‹é—´çš„å·®å¼‚ä¼šè¢«è¿…é€Ÿå‡åŒ–ï¼Œ<strong>ä»¥ä¸Šçš„é—®é¢˜åªæ˜¯å› ä¸ºæ•°æ®é‡å¤ªå°‘äº†</strong>ã€‚</p>
<h2 id="æœ€ä½³å­—æ®µ"><a href="#æœ€ä½³å­—æ®µ" class="headerlink" title="æœ€ä½³å­—æ®µ"></a>æœ€ä½³å­—æ®µ</h2><p>ä»€ä¹ˆæ˜¯æœ€ä½³å­—æ®µï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆäº†è§£ä»€ä¹ˆæ˜¯ç«äº‰å…³ç³»ã€‚</p>
<p>ä¸‹é¢æ˜¯ä¸¤æ¡æ–‡æ¡£, å‡è®¾æˆ‘ä»¬éœ€è¦æœç´¢â€Brown foxâ€ä¸¤ä¸ªå…³é”®è¯å¹¶ä¸”éœ€è¦åŒæ—¶æ£€ç´¢â€titleâ€å’Œâ€bodyâ€ä¸¤ä¸ªå­—æ®µçš„æ—¶å€™ã€‚æ–‡æ¡£2çš„bodyå­—æ®µè™½ç„¶åŒæ—¶åŒ¹é…äº†ä¸¤ä¸ªå…³é”®è¯, ä½†æ˜¯æ–‡æ¡£2çš„titleæ²¡æœ‰åŒ¹é…åˆ°ä»»ä½•çš„å…³é”®è¯ã€‚æ‰€ä»¥ç›¸å…³æ€§ç®—åˆ†, æ–‡æ¡£2æ˜¯ä½äºæ–‡æ¡£1çš„ã€‚</p>
<p>ä½†æ˜¯å¦‚æœå–<strong>æœ€ä½³å­—æ®µ</strong>çš„è¯„åˆ†ï¼Œæ–‡æ¡£2çš„bodyå­—æ®µä¸ºæœ€ä½³å­—æ®µ, æ–‡æ¡£2çš„è¯„åˆ†æ˜¯é«˜äºæ–‡æ¡£1çš„è¯„åˆ†çš„</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"title"</span>: <span class="string">"Quick brown rabbits"</span>,</span><br><span class="line">  <span class="string">"body"</span>:  <span class="string">"Brown rabbits are commonly seen."</span></span><br><span class="line">&#125;</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"title"</span>: <span class="string">"Keeping pets healthy"</span>,</span><br><span class="line">  <span class="string">"body"</span>:  <span class="string">"My quick brown fox eats rabbits on a regular basis."</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="dis-max"><a href="#dis-max" class="headerlink" title="dis_max"></a>dis_max</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// åœ¨æœ€åè®¡ç®—æ–‡æ¡£çš„ç›¸å…³æ€§ç®—åˆ†çš„æ—¶å€™, åªä¼šå–queriesä¸­çš„ç›¸å…³æ€§çš„æœ€å¤§å€¼</span></span><br><span class="line"></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"dis_max"</span>: &#123;</span><br><span class="line">      <span class="string">"queries"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"match"</span>: &#123;</span><br><span class="line">            <span class="string">"FIELD1"</span>: <span class="string">"TEXT1"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"match"</span>: &#123;</span><br><span class="line">            <span class="string">"FIELD2"</span>: <span class="string">"TEXT2"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="tie-breaker"><a href="#tie-breaker" class="headerlink" title="tie_breaker"></a>tie_breaker</h3><p>ä½¿ç”¨dis_maxæœ€ä½³å­—æ®µå¯èƒ½å­˜åœ¨å¦å¤–çš„é—®é¢˜å°±æ˜¯ã€‚å¦‚æœåŒæ—¶æŸ¥è¯¢å¤šä¸ªå­—æ®µ, å¦‚æœä¸€ä¸ªæ–‡æ¡£åŒæ—¶åŒ¹é…äº†å¤šä¸ªå­—æ®µï¼Œä½†æ˜¯ç”±äºæ–‡æ¡£çš„ç›¸å…³æ€§ç®—åˆ†å–çš„æ˜¯æœ€ä½³å­—æ®µ, å¯èƒ½å¯¼è‡´è¯¥æ–‡æ¡£çš„ç›¸å…³æ€§ç®—åˆ†å¹¶ä¸æ˜¯æœ€é«˜çš„ã€‚</p>
<p>ä½¿ç”¨tie_breakerå‚æ•°ï¼Œå¯ä»¥å°†å…¶ä»–åŒ¹é…è¯­å¥çš„è¯„åˆ†ä¹Ÿè®¡ç®—åœ¨å†…ã€‚å°†å…¶ä»–åŒ¹é…è¯­å¥çš„è¯„åˆ†ç»“æœä¸tie_breakerç›¸ä¹˜, æœ€åä¸æœ€ä½³å­—æ®µçš„è¯„åˆ†æ±‚å’Œå¾—å‡ºæ–‡æ¡£çš„ç®—åˆ†ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"dis_max"</span>: &#123;</span><br><span class="line">      <span class="string">"tie_breaker"</span>: <span class="number">0.3</span>,</span><br><span class="line">      <span class="string">"queries"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"match"</span>: &#123;</span><br><span class="line">            <span class="string">"FIELD1"</span>: <span class="string">"TEXT1"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"match"</span>: &#123;</span><br><span class="line">            <span class="string">"FIELD2"</span>: <span class="string">"TEXT2"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="multi-match"><a href="#multi-match" class="headerlink" title="multi_match"></a>multi_match</h2><p>å¤šå­—æ®µçš„matchæŸ¥è¯¢, ä¸ºå¤šä¸ªå­—æ®µæ‰§è¡Œç›¸åŒçš„matchæŸ¥è¯¢ã€‚multi_matchæŸ¥è¯¢é»˜è®¤å–æœ€ä½³å­—æ®µçš„ç›¸å…³æ€§ç®—åˆ†</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// ä¸‹é¢ä¸¤ç§æŸ¥è¯¢æ˜¯ç­‰åŒçš„</span></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"dis_max"</span>: &#123;</span><br><span class="line">      <span class="string">"queries"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"match"</span>: &#123;</span><br><span class="line">            <span class="string">"FIELD1"</span>: <span class="string">"TEXT1"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"match"</span>: &#123;</span><br><span class="line">            <span class="string">"FIELD2"</span>: <span class="string">"TEXT1"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"multi_match"</span>: &#123;</span><br><span class="line">      <span class="string">"query"</span>: <span class="string">"TEXT1"</span>,</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"best_fields"</span>, <span class="comment">// å–æœ€ä½³å­—æ®µçš„ç›¸å…³æ€§ç®—åˆ†</span></span><br><span class="line">      <span class="string">"fields"</span>: [</span><br><span class="line">        <span class="string">"FIELD1"</span>,</span><br><span class="line">        <span class="string">"FIELD2"</span>,</span><br><span class="line">        <span class="string">"FIELD3^2"</span> <span class="comment">// å¯ä»¥æŒ‡å®šçš„æŸ¥è¯¢å­—æ®µçš„æƒé‡, å¦‚æœåŒ¹é…FIELD3å­—æ®µå¾—åˆ†å°†ä¼šæ›´é«˜</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="fields"><a href="#fields" class="headerlink" title="fields"></a>fields</h2><p>fieldsæ˜¯å¯¹åŒä¸€ä¸ªå­—æ®µç´¢å¼•å¤šæ¬¡, æ¯ä¸€ä¸ªå­—æ®µä¸åŒçš„fieldså¯ä»¥å®šä¹‰ä¸åŒçš„typeä»¥åŠåˆ†æå™¨ï¼Œç”¨åšä¸åŒçš„ç”¨é€”</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// titleä¸ºtextç±»å‹</span></span><br><span class="line"><span class="comment">// title.keywordä¸ºkeywordç±»å‹</span></span><br><span class="line"><span class="comment">// title.englishä½¿ç”¨englishçš„åˆ†æå™¨</span></span><br><span class="line"></span><br><span class="line">PUT test3_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"mappings"</span>: &#123;</span><br><span class="line">    <span class="string">"doc"</span>: &#123;</span><br><span class="line">      <span class="string">"properties"</span>: &#123;</span><br><span class="line">        <span class="string">"title"</span>: &#123;</span><br><span class="line">          <span class="string">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">          <span class="string">"fields"</span>: &#123;</span><br><span class="line">            <span class="string">"keyword"</span>: &#123;</span><br><span class="line">              <span class="string">"type"</span>: <span class="string">"keyword"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"english"</span>: &#123;</span><br><span class="line">              <span class="string">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">              <span class="string">"analyzer"</span>: <span class="string">"english"</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="è·¨å­—æ®µå®ä½“æœç´¢"><a href="#è·¨å­—æ®µå®ä½“æœç´¢" class="headerlink" title="è·¨å­—æ®µå®ä½“æœç´¢"></a>è·¨å­—æ®µå®ä½“æœç´¢</h2><p>æ¯”å¦‚ä¸€ä¸ªäººçš„ä¿¡æ¯ï¼ŒåŒ…å«å§“åï¼Œç”µè¯å·ç ï¼Œå®¶åº­ä½å€ç­‰å¤šä¸ªå­—æ®µã€‚å¦‚æœæƒ³è¦æœç´¢äººçš„ä¿¡æ¯ï¼Œå¯èƒ½éœ€è¦æ£€ç´¢å¤šä¸ªå­—æ®µã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å§“å, æ‰‹æœºå·, å®¶åº­ä½å€å­—æ®µéƒ½åŒ…å«äº†ä¸€ä¸ªäººçš„ä¿¡æ¯</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span>: <span class="string">"Frank"</span>,</span><br><span class="line">  <span class="string">"mobi"</span>: <span class="string">"13053127868"</span>,</span><br><span class="line">  <span class="string">"hours"</span>: <span class="string">"bengbu"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æœ€ç›´æ¥çš„æ£€ç´¢çš„æ–¹å¼æ˜¯é€šè¿‡multi_matchæˆ–è€…boolçš„shouldå®ç°å¯¹å¤šä¸ªå­—æ®µçš„æ£€ç´¢</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">GET test_index/doc/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"bool"</span>: &#123;</span><br><span class="line">      <span class="string">"should"</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"match"</span>: &#123;</span><br><span class="line">            <span class="string">"name"</span>: <span class="string">"Frank 1305312786"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"mathch"</span>: &#123;</span><br><span class="line">            <span class="string">"mobi"</span>: <span class="string">"Frank 13053127868"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">"mathch"</span>: &#123;</span><br><span class="line">            <span class="string">"hours"</span>: <span class="string">"Frank 13053127868"</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"multi_match"</span>: &#123;</span><br><span class="line">      <span class="string">"query"</span>: <span class="string">"Frank 1305312786"</span>,</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"most_fields"</span>, <span class="comment">// åˆå¹¶åŒ¹é…å­—æ®µçš„è¯„åˆ†, ä¸ä½¿ç”¨æœ€ä½³å­—æ®µçš„è¯„åˆ†</span></span><br><span class="line">      <span class="string">"fields"</span>: [ <span class="string">"name"</span>, <span class="string">"mobi"</span>, <span class="string">"hours"</span> ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="è·¨å­—æ®µæ£€ç´¢çš„é—®é¢˜"><a href="#è·¨å­—æ®µæ£€ç´¢çš„é—®é¢˜" class="headerlink" title="è·¨å­—æ®µæ£€ç´¢çš„é—®é¢˜"></a>è·¨å­—æ®µæ£€ç´¢çš„é—®é¢˜</h3><ol>
<li>åœ¨åŒä¸€ä¸ªå­—æ®µåŒ¹é…åˆ°å¤šä¸ªå…³é”®è¯çš„ç›¸å…³æ€§ç®—åˆ†ï¼Œè¦å°äºå¤šä¸ªå­—æ®µåŒ¹é…åŒä¸€ä¸ªå…³é”®è¯çš„ç®—åˆ†ã€‚</li>
<li>ä½¿ç”¨andæ“ä½œç¬¦, ä¼šå¯¼è‡´æ‰€æœ‰æŸ¥è¯¢å˜ä¸ºæ‰€æœ‰å…³é”®è¯éƒ½å¿…é¡»è¦åœ¨åŒä¸€ä¸ªå­—æ®µåŒ¹é…ã€‚</li>
<li>é€†å‘æ–‡æ¡£é¢‘ç‡çš„é—®é¢˜, å½“ä¸€ä¸ªæŸ¥è¯¢å…·æœ‰è¾ƒä½çš„é€†å‘æ–‡æ¡£é¢‘ç‡(ç›¸å…³åº¦è¾ƒé«˜)ã€‚å¯èƒ½ä¼šå‰Šå¼±è¾ƒé«˜çš„é€†å‘æ–‡æ¡£é¢‘ç‡(ç›¸å…³åº¦è¾ƒä½)çš„ä½œç”¨ã€‚</li>
</ol>
<h3 id="all"><a href="#all" class="headerlink" title="_all"></a>_all</h3><p>ä½¿ç”¨copy_toçš„åŠŸèƒ½ï¼Œå°†å¤šä¸ªå­—æ®µå†…å®¹æ‹·è´åˆ°æ–‡æ¡£çš„ä¸€ä¸ªå­—æ®µä¸­ã€‚æ£€ç´¢æ—¶ä½¿ç”¨åˆå¹¶çš„å­—æ®µè¿›è¡Œæ£€ç´¢ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">PUT test3_index</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"mappings"</span>: &#123;</span><br><span class="line">    <span class="string">"doc"</span>: &#123;</span><br><span class="line">      <span class="string">"properties"</span>: &#123;</span><br><span class="line">        <span class="string">"name"</span>: &#123;</span><br><span class="line">          <span class="string">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">          <span class="string">"copy_to"</span>: <span class="string">"info"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"mobi"</span>: &#123;</span><br><span class="line">          <span class="string">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">          <span class="string">"copy_to"</span>: <span class="string">"info"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"hours"</span>: &#123;</span><br><span class="line">          <span class="string">"type"</span>: <span class="string">"text"</span>,</span><br><span class="line">          <span class="string">"copy_to"</span>: <span class="string">"info"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"info"</span>: &#123;</span><br><span class="line">          <span class="string">"type"</span>: <span class="string">"text"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æŸ¥è¯¢æ—¶å¯ä»¥ç›´æ¥é€šè¿‡infoå­—æ®µæŸ¥è¯¢</span></span><br><span class="line">GET test3_index/doc/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"match"</span>: &#123;</span><br><span class="line">      <span class="string">"info"</span>: <span class="string">"Frank 1305312786"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="cross-fields"><a href="#cross-fields" class="headerlink" title="cross-fields"></a>cross-fields</h3><p>å½“multi_matchçš„typeç­‰äºcross-fieldsæ—¶, å®ƒå°†æ‰€æœ‰fieldsä¸­çš„å­—æ®µå½“æˆä¸€ä¸ªå¤§å­—æ®µï¼Œå¹¶åœ¨è¿™ä¸ªå¤§å­—æ®µä¸­è¿›è¡Œæ£€ç´¢ã€‚</p>
<p>åŒæ—¶ä¹Ÿä¼šè§£å†³é€†å‘æ–‡æ¡£é¢‘ç‡çš„é—®é¢˜, å› ä¸ºcross-fieldsä¼šå–ä¸åŒå­—æ®µä¸­æœ€é«˜çš„é€†å‘æ–‡æ¡£é¢‘ç‡(ç›¸å…³åº¦æœ€ä½çš„)çš„å€¼ã€‚</p>
<p>cross-fieldsæ—¶ï¼Œæ‰€æœ‰å­—æ®µå¿…é¡»ä¸ºåŒä¸€ç§åˆ†æå™¨ã€‚å¦‚æœåŒ…æ‹¬äº†ä¸åŒåˆ†æå™¨çš„å­—æ®µï¼Œå®ƒä»¬ä¼šä»¥best_fieldsçš„ç›¸åŒæ–¹å¼è¢«åŠ å…¥åˆ°æŸ¥è¯¢ç»“æœä¸­</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// abc efgå¿…é¡»åŒæ—¶å‡ºç°åœ¨FIELD1æˆ–è€…FIELD2æ–‡æ¡£ä¸­</span></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"multi_match"</span>: &#123;</span><br><span class="line">      <span class="string">"query"</span>: <span class="string">"abc efg"</span>,</span><br><span class="line">      <span class="string">"fields"</span>: [<span class="string">"FIELD1"</span>, <span class="string">"FIELD2"</span>],</span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"most_fields"</span>,</span><br><span class="line">      <span class="string">"operator"</span>: <span class="string">"and"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// abc efgå¿…é¡»å‡ºç°ä½†æ˜¯å¯ä»¥åœ¨FIELD1æˆ–è€…FIELD2ä¸åŒçš„å­—æ®µä¸­</span></span><br><span class="line">GET swmgame-activity<span class="number">-2018.06</span>/my_index/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    <span class="string">"multi_match"</span>: &#123;</span><br><span class="line">      <span class="string">"query"</span>: <span class="string">"abc efg"</span>,</span><br><span class="line">      <span class="string">"fields"</span>: [<span class="string">"FIELD1^2"</span>, <span class="string">"FIELD2"</span>], <span class="comment">// å¯ä»¥æé«˜å­—æ®µçš„æƒé‡</span></span><br><span class="line">      <span class="string">"type"</span>: <span class="string">"cross_fields"</span>,</span><br><span class="line">      <span class="string">"operator"</span>: <span class="string">"and"</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾…ç»­â€¦.</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Elasticsearch/" rel="tag"># Elasticsearch</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/06/12/Elasticsearch/" rel="next" title="Elasticsearchå…¥é—¨ (1)">
                <i class="fa fa-chevron-left"></i> Elasticsearchå…¥é—¨ (1)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/06/24/Elasticsearch03/" rel="prev" title="Elasticsearchå…¥é—¨ (3)">
                Elasticsearchå…¥é—¨ (3) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpeg"
                alt="å¼ è¶Š" />
            
              <p class="site-author-name" itemprop="name">å¼ è¶Š</p>
              <p class="site-description motion-element" itemprop="description">æ‰€è°“æˆé•¿ï¼Œå°±æ˜¯ç»è¿‡ä¸æ–­çš„èšæ•£ç¦»åˆï¼Œæ‰¾åˆ°ä¸å¤ªä¼šä¼¤å®³åˆ°å½¼æ­¤çš„è·ç¦»</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">67</span>
                  <span class="site-state-item-name">ç¯‡åšæ–‡</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">31</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/BengBu-YueZhang" target="_blank" title="æˆ‘çš„GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>æˆ‘çš„GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/5460100952/profile?topnav=1&wvr=6" target="_blank" title="æˆ‘çš„å¾®åš">
                      
                        <i class="fa fa-fw fa-globe"></i>æˆ‘çš„å¾®åš</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#å¯¼å…¥"><span class="nav-number">1.</span> <span class="nav-text">å¯¼å…¥</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#æœç´¢"><span class="nav-number">2.</span> <span class="nav-text">æœç´¢</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ç²¾ç¡®å€¼æœç´¢"><span class="nav-number">2.1.</span> <span class="nav-text">ç²¾ç¡®å€¼æœç´¢</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#termæŸ¥è¯¢æ•°å­—"><span class="nav-number">2.1.1.</span> <span class="nav-text">termæŸ¥è¯¢æ•°å­—</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#termæŸ¥è¯¢æ–‡æœ¬"><span class="nav-number">2.1.2.</span> <span class="nav-text">termæŸ¥è¯¢æ–‡æœ¬</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#termæŸ¥è¯¢èŒƒå›´ç±»å‹"><span class="nav-number">2.1.3.</span> <span class="nav-text">termæŸ¥è¯¢èŒƒå›´ç±»å‹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç»„åˆè¿‡æ»¤å™¨"><span class="nav-number">2.2.</span> <span class="nav-text">ç»„åˆè¿‡æ»¤å™¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#terms"><span class="nav-number">2.3.</span> <span class="nav-text">terms</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#range"><span class="nav-number">2.4.</span> <span class="nav-text">range</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ•°å­—èŒƒå›´æŸ¥è¯¢-ğŸ”¢"><span class="nav-number">2.4.1.</span> <span class="nav-text">æ•°å­—èŒƒå›´æŸ¥è¯¢ ğŸ”¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ—¥æœŸèŒƒå›´æŸ¥è¯¢-ğŸ“…"><span class="nav-number">2.4.2.</span> <span class="nav-text">æ—¥æœŸèŒƒå›´æŸ¥è¯¢ ğŸ“…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å­—ç¬¦ä¸²èŒƒå›´æŸ¥è¯¢-ğŸ“–"><span class="nav-number">2.4.3.</span> <span class="nav-text">å­—ç¬¦ä¸²èŒƒå›´æŸ¥è¯¢ ğŸ“–</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¤„ç†Nullå€¼"><span class="nav-number">2.5.</span> <span class="nav-text">å¤„ç†Nullå€¼</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å­˜åœ¨æŸ¥è¯¢"><span class="nav-number">2.5.1.</span> <span class="nav-text">å­˜åœ¨æŸ¥è¯¢</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¼ºå¤±æŸ¥è¯¢"><span class="nav-number">2.5.2.</span> <span class="nav-text">ç¼ºå¤±æŸ¥è¯¢</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å…¨æ–‡æœç´¢"><span class="nav-number">2.6.</span> <span class="nav-text">å…¨æ–‡æœç´¢</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#åŸºæœ¬æ¦‚å¿µ"><span class="nav-number">2.6.1.</span> <span class="nav-text">åŸºæœ¬æ¦‚å¿µ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸºäºè¯é¡¹"><span class="nav-number">2.6.1.1.</span> <span class="nav-text">åŸºäºè¯é¡¹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#åŸºäºå…¨æ–‡"><span class="nav-number">2.6.1.2.</span> <span class="nav-text">åŸºäºå…¨æ–‡</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åŒ¹é…æŸ¥è¯¢"><span class="nav-number">2.7.</span> <span class="nav-text">åŒ¹é…æŸ¥è¯¢</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¤šè¯æŸ¥è¯¢"><span class="nav-number">2.8.</span> <span class="nav-text">å¤šè¯æŸ¥è¯¢</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æœ€å°åŒ¹é…æ•°"><span class="nav-number">2.8.1.</span> <span class="nav-text">æœ€å°åŒ¹é…æ•°</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç»„åˆæŸ¥è¯¢"><span class="nav-number">2.9.</span> <span class="nav-text">ç»„åˆæŸ¥è¯¢</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æƒé‡"><span class="nav-number">2.10.</span> <span class="nav-text">æƒé‡</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é»˜è®¤çš„åˆ†æå™¨"><span class="nav-number">2.11.</span> <span class="nav-text">é»˜è®¤çš„åˆ†æå™¨</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç›¸å…³åº¦è¢«ç ´å"><span class="nav-number">2.12.</span> <span class="nav-text">ç›¸å…³åº¦è¢«ç ´å</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æœ€ä½³å­—æ®µ"><span class="nav-number">2.13.</span> <span class="nav-text">æœ€ä½³å­—æ®µ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#dis-max"><span class="nav-number">2.13.1.</span> <span class="nav-text">dis_max</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tie-breaker"><span class="nav-number">2.13.2.</span> <span class="nav-text">tie_breaker</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#multi-match"><span class="nav-number">2.14.</span> <span class="nav-text">multi_match</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#fields"><span class="nav-number">2.15.</span> <span class="nav-text">fields</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è·¨å­—æ®µå®ä½“æœç´¢"><span class="nav-number">2.16.</span> <span class="nav-text">è·¨å­—æ®µå®ä½“æœç´¢</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#è·¨å­—æ®µæ£€ç´¢çš„é—®é¢˜"><span class="nav-number">2.16.1.</span> <span class="nav-text">è·¨å­—æ®µæ£€ç´¢çš„é—®é¢˜</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#all"><span class="nav-number">2.16.2.</span> <span class="nav-text">_all</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cross-fields"><span class="nav-number">2.16.3.</span> <span class="nav-text">cross-fields</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">å¼ è¶Š</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
