<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="canvas," />










<meta name="keywords" content="canvas">
<meta property="og:type" content="article">
<meta property="og:title" content="canvas入门以及简单应用">
<meta property="og:url" content="https://bengbu-yuezhang.github.io/yue.github.io/2019/02/03/learncanvas/index.html">
<meta property="og:site_name" content="新世紀エヴァンゲリオン">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://unsplash.it/1080/579?random">
<meta property="og:image" content="https://i.loli.net/2019/02/04/5c57d2f61278d.png">
<meta property="og:image" content="https://i.loli.net/2019/02/04/5c57d350215fe.png">
<meta property="og:image" content="https://i.loli.net/2019/02/04/5c57d4d654d69.png">
<meta property="og:image" content="https://developer.mozilla.org/@api/deki/files/601/=Canvas-grid.png">
<meta property="og:image" content="https://developer.mozilla.org/@api/deki/files/88/=Canvas_linecap.png">
<meta property="og:image" content="https://i.loli.net/2019/02/04/5c57e1c9cf4aa.png">
<meta property="og:image" content="https://i.loli.net/2019/02/04/5c57e42b1dd07.png">
<meta property="og:image" content="https://i.loli.net/2019/02/04/5c57e462cfe1d.png">
<meta property="og:image" content="https://i.loli.net/2019/01/27/5c4da4f295ede.png">
<meta property="og:image" content="https://developer.mozilla.org/@api/deki/files/79/=Canvas_drawimage.jpg">
<meta property="og:image" content="https://developer.mozilla.org/@api/deki/files/84/=Canvas_grid_rotate.png">
<meta property="og:image" content="https://i.loli.net/2019/02/05/5c59975620b43.png">
<meta property="og:image" content="https://i.loli.net/2019/02/06/5c59b8ca284ca.png">
<meta property="og:image" content="https://i.loli.net/2019/02/06/5c59bde2e07a9.png">
<meta property="og:updated_time" content="2019-02-06T01:35:35.492Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="canvas入门以及简单应用">
<meta name="twitter:image" content="https://unsplash.it/1080/579?random">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://bengbu-yuezhang.github.io/yue.github.io/2019/02/03/learncanvas/"/>





  <title>canvas入门以及简单应用 | 新世紀エヴァンゲリオン</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">新世紀エヴァンゲリオン</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">前端小学生</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://bengbu-yuezhang.github.io/yue.github.io/2019/02/03/learncanvas/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="张越">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="新世紀エヴァンゲリオン">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">canvas入门以及简单应用</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-02-03T00:17:38+08:00">
                2019-02-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="https://unsplash.it/1080/579?random" alt="image"></p>
<a id="more"></a>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>强烈推荐MDN上关于<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API" target="_blank" rel="noopener">Canvas的教程文档</a>, 非常的详尽以及通俗易懂。我在学习过程中就是结合该文档以及众多的示例。这一篇博客其实挺难产的, 写的也非常水, 因为MDN上的这一篇教程真的非常完善详细, 我真的没什么好写的。很多效果可以参考我的源码。</p>
<h2 id="基础API"><a href="#基础API" class="headerlink" title="基础API"></a>基础API</h2><blockquote>
<p>这里将对Canvas常用的API做一个汇总介绍, 更详细的解释说明请参考MDN文档。可以跳过不看，直接看一些效果的实现思路。</p>
</blockquote>
<h3 id="形状-线条"><a href="#形状-线条" class="headerlink" title="形状, 线条"></a>形状, 线条</h3><h4 id="形状"><a href="#形状" class="headerlink" title="形状"></a>形状</h4><h5 id="fillRect"><a href="#fillRect" class="headerlink" title="fillRect"></a>fillRect</h5><p>fillRect(x, y, w, h), 绘制一个填充矩形</p>
<h5 id="strokeRect"><a href="#strokeRect" class="headerlink" title="strokeRect"></a>strokeRect</h5><p>strokeRect(x, y, w, h), 绘制一个矩形边框</p>
<h5 id="clearRect"><a href="#clearRect" class="headerlink" title="clearRect"></a>clearRect</h5><p>clearRect(x, y, w, h), 清除指定矩形内的像素</p>
<h4 id="路径"><a href="#路径" class="headerlink" title="路径"></a>路径</h4><h5 id="beginPath"><a href="#beginPath" class="headerlink" title="beginPath"></a>beginPath</h5><p>beginPath 开始绘制路径</p>
<h5 id="moveTo"><a href="#moveTo" class="headerlink" title="moveTo"></a>moveTo</h5><p>moveTo(x, y), 将画笔移动到指定的位置</p>
<h5 id="lineTo"><a href="#lineTo" class="headerlink" title="lineTo"></a>lineTo</h5><p>lineTo(x, y), 绘制从上一个点到当前(x, y)点的线</p>
<h5 id="closePath"><a href="#closePath" class="headerlink" title="closePath"></a>closePath</h5><p>闭合路径, canvas会绘制当前点到起始点的直线用来闭合路径</p>
<h5 id="fill"><a href="#fill" class="headerlink" title="fill"></a>fill</h5><p>对闭合的路径进行填充, fill操作会对未闭合的路径自动闭合</p>
<h5 id="stroke"><a href="#stroke" class="headerlink" title="stroke"></a>stroke</h5><p>绘制图形轮廓, stroke操作需要手动闭合路径</p>
<h5 id="arc"><a href="#arc" class="headerlink" title="arc"></a>arc</h5><p>弧度 = (Math.PI/180) * 角度</p>
<p>arc(x, y, r, start, end, true), arc用来绘制圆弧, x, y指点圆心, r为半径, start, end为开始弧度和结束弧度, true为顺时针或者逆时针。</p>
<p>arc同绘制路径一样，需要闭合路径。（fill不用, fill会自动闭合路径）</p>
<h5 id="quadraticCurveTo-二次贝塞尔曲线"><a href="#quadraticCurveTo-二次贝塞尔曲线" class="headerlink" title="quadraticCurveTo 二次贝塞尔曲线"></a>quadraticCurveTo 二次贝塞尔曲线</h5><p><a href="http://blogs.sitepointstatic.com/examples/tech/canvas-curves/quadratic-curve.html" target="_blank" rel="noopener">二次贝塞尔曲线生成器</a></p>
<p>quadraticCurveTo(控制点x, 控制点y, 结束x, 结束y), 从上一点开始到结束点x, y绘制直线。控制点x, y可以用来控制直线的弯曲程度。</p>
<p><img src="https://i.loli.net/2019/02/04/5c57d2f61278d.png" alt="image"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)</span><br><span class="line"><span class="keyword">let</span> ctx = canvas.getContext(<span class="string">'2d'</span>)</span><br><span class="line"></span><br><span class="line">ctx.beginPath()</span><br><span class="line">ctx.moveTo(<span class="number">100</span>, <span class="number">250</span>)</span><br><span class="line">ctx.quadraticCurveTo(<span class="number">101</span>, <span class="number">308</span>, <span class="number">200</span>, <span class="number">250</span>)</span><br><span class="line">ctx.stroke()</span><br></pre></td></tr></table></figure>
<h5 id="bezierCurveTo-三次贝塞尔曲线"><a href="#bezierCurveTo-三次贝塞尔曲线" class="headerlink" title="bezierCurveTo 三次贝塞尔曲线"></a>bezierCurveTo 三次贝塞尔曲线</h5><p><a href="http://www.victoriakirst.com/beziertool/" target="_blank" rel="noopener">三次贝塞尔曲线生成器</a></p>
<p>bezierCurveTo(控制点x1, 控制点y1, 控制点x2, 控制点y2, 结束x, 结束y), 从上一点开始到结束点x, y绘制直线。两个控制点可以控制直线的弯曲程度。</p>
<p><img src="https://i.loli.net/2019/02/04/5c57d350215fe.png" alt="image"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 绘制红心</span></span><br><span class="line"><span class="keyword">let</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)</span><br><span class="line"><span class="keyword">let</span> ctx = canvas.getContext(<span class="string">'2d'</span>)</span><br><span class="line"></span><br><span class="line">ctx.fillStyle = <span class="string">'#d32f2f'</span></span><br><span class="line">ctx.beginPath();</span><br><span class="line">ctx.moveTo(<span class="number">240</span>, <span class="number">150</span>);</span><br><span class="line">ctx.bezierCurveTo(<span class="number">190</span>, <span class="number">120</span>, <span class="number">170</span>, <span class="number">190</span>, <span class="number">240</span>, <span class="number">230</span>)</span><br><span class="line">ctx.bezierCurveTo(<span class="number">310</span>, <span class="number">190</span>, <span class="number">290</span>, <span class="number">120</span>, <span class="number">240</span>, <span class="number">150</span>)</span><br><span class="line">ctx.fill()</span><br></pre></td></tr></table></figure>
<h5 id="Path2D"><a href="#Path2D" class="headerlink" title="Path2D"></a>Path2D</h5><blockquote>
<p>Path2D, Path2D可以将实现绘制好的图形缓存起来。需要用到的时候, 再通过上下文对象将Path2D缓存的图像绘制出来。</p>
</blockquote>
<p><img src="https://i.loli.net/2019/02/04/5c57d4d654d69.png" alt="image"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)</span><br><span class="line"><span class="keyword">let</span> ctx = canvas.getContext(<span class="string">'2d'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绘制一个矩形</span></span><br><span class="line"><span class="keyword">let</span> rectangle = <span class="keyword">new</span> Path2D()</span><br><span class="line">rectangle.rect(<span class="number">10</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">50</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绘制一个圆形</span></span><br><span class="line"><span class="keyword">let</span> circle = <span class="keyword">new</span> Path2D()</span><br><span class="line">circle.moveTo(<span class="number">125</span>, <span class="number">35</span>)</span><br><span class="line">circle.arc(<span class="number">100</span>, <span class="number">35</span>, <span class="number">25</span>, <span class="number">0</span>, <span class="number">2</span> * <span class="built_in">Math</span>.PI)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 绘制Path2D缓存对象</span></span><br><span class="line">ctx.stroke(rectangle)</span><br><span class="line">ctx.fill(circle)</span><br></pre></td></tr></table></figure>
<h3 id="颜色样式"><a href="#颜色样式" class="headerlink" title="颜色样式"></a>颜色样式</h3><h4 id="颜色"><a href="#颜色" class="headerlink" title="颜色"></a>颜色</h4><h5 id="fillStyle"><a href="#fillStyle" class="headerlink" title="fillStyle"></a>fillStyle</h5><p>设置填充色, 支持16进制的颜色或者rgba的颜色</p>
<h5 id="strokeStyle"><a href="#strokeStyle" class="headerlink" title="strokeStyle"></a>strokeStyle</h5><p>设置边框的填充色, 支持16进制的颜色或者rgba的颜色</p>
<h4 id="透明度"><a href="#透明度" class="headerlink" title="透明度"></a>透明度</h4><p>透明度的设置有两种解决方案</p>
<ol>
<li>使用rgba的颜色对fillStyle或者strokeStyle进行设置</li>
<li>使用globalAlpha设置全局的透明度。</li>
</ol>
<p>globalAlpha设置透明度后, 接下来绘制的图形均含有透明度</p>
<h4 id="线条样式"><a href="#线条样式" class="headerlink" title="线条样式"></a>线条样式</h4><h5 id="lineWidth"><a href="#lineWidth" class="headerlink" title="lineWidth"></a>lineWidth</h5><p>设置线的宽度, <strong>宽度为奇数的线并不能精确呈现(未填充满的线条, 会取颜色的一半绘制), 如下图所示。如果需要宽度为1的线, 我们需要对坐标进行更精准的控制。比如设置3.5的x坐标</strong></p>
<p><img src="https://developer.mozilla.org/@api/deki/files/601/=Canvas-grid.png" alt="image"></p>
<h5 id="lineCap"><a href="#lineCap" class="headerlink" title="lineCap"></a>lineCap</h5><p>线的尾部的样式, 依次分别是butt, round, square(多出来的是线的宽度的一半)</p>
<p><img src="https://developer.mozilla.org/@api/deki/files/88/=Canvas_linecap.png" alt="image"></p>
<h4 id="渐变色"><a href="#渐变色" class="headerlink" title="渐变色"></a>渐变色</h4><h5 id="线性渐变-createLinearGradient"><a href="#线性渐变-createLinearGradient" class="headerlink" title="线性渐变 createLinearGradient"></a>线性渐变 createLinearGradient</h5><p>createLinearGradient(x1, y1, x2, y2), 设置渐变的起始点和结束点坐标。</p>
<h5 id="addColorStop"><a href="#addColorStop" class="headerlink" title="addColorStop"></a>addColorStop</h5><p>addColorStop则是给渐变上色。addColorStop指定两个参数百分比以及颜色。</p>
<p><img src="https://i.loli.net/2019/02/04/5c57e1c9cf4aa.png" alt="image"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)</span><br><span class="line"><span class="keyword">let</span> ctx = canvas.getContext(<span class="string">'2d'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建渐变色</span></span><br><span class="line"><span class="keyword">let</span> linecolor = ctx.createLinearGradient(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">200</span>)</span><br><span class="line"><span class="comment">// 0%位置颜色为#e3f2fd</span></span><br><span class="line">linecolor.addColorStop(<span class="number">0</span>, <span class="string">'#e3f2fd'</span>)</span><br><span class="line"><span class="comment">// 100%位置颜色为#0d47a1</span></span><br><span class="line">linecolor.addColorStop(<span class="number">1</span>, <span class="string">'#0d47a1'</span>)</span><br><span class="line"></span><br><span class="line">ctx.fillStyle = linecolor</span><br><span class="line">ctx.fillRect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">200</span>, <span class="number">200</span>)</span><br></pre></td></tr></table></figure>
<h5 id="径向渐变-createRadialGradient"><a href="#径向渐变-createRadialGradient" class="headerlink" title="径向渐变 createRadialGradient"></a>径向渐变 createRadialGradient</h5><p>canvas中的径向渐变不同于传统ps中的径向渐变(单一的中心点), canvas中可以设置两个中心点, 由两个中心点向外扩散渐变色</p>
<h4 id="阴影"><a href="#阴影" class="headerlink" title="阴影"></a>阴影</h4><h5 id="shadowOffsetX"><a href="#shadowOffsetX" class="headerlink" title="shadowOffsetX"></a>shadowOffsetX</h5><p>x方向的偏移量</p>
<h5 id="shadowOffsetY"><a href="#shadowOffsetY" class="headerlink" title="shadowOffsetY"></a>shadowOffsetY</h5><p>y方向的偏移量</p>
<h5 id="shadowColor"><a href="#shadowColor" class="headerlink" title="shadowColor"></a>shadowColor</h5><p>阴影的颜色</p>
<h5 id="shadowBlur"><a href="#shadowBlur" class="headerlink" title="shadowBlur"></a>shadowBlur</h5><p>阴影的模糊程度</p>
<p><img src="https://i.loli.net/2019/02/04/5c57e42b1dd07.png" alt="image"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)</span><br><span class="line"><span class="keyword">let</span> ctx = canvas.getContext(<span class="string">'2d'</span>)</span><br><span class="line"></span><br><span class="line">ctx.shadowOffsetX = <span class="number">2</span>;</span><br><span class="line">ctx.shadowOffsetY = <span class="number">2</span>;</span><br><span class="line">ctx.shadowBlur = <span class="number">2</span>;</span><br><span class="line">ctx.shadowColor = <span class="string">"rgba(0, 0, 0, 0.5)"</span>;</span><br><span class="line"></span><br><span class="line">ctx.fillStyle = <span class="string">"Yellow"</span>;</span><br><span class="line"></span><br><span class="line">ctx.fillRect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">100</span>)</span><br></pre></td></tr></table></figure>
<h4 id="Patterns-图片填充"><a href="#Patterns-图片填充" class="headerlink" title="Patterns 图片填充"></a>Patterns 图片填充</h4><p>createPattern可以使用图片对canvas的图形进行填充。但是图片必须加载完成后才会生效。</p>
<p><img src="https://i.loli.net/2019/02/04/5c57e462cfe1d.png" alt="image"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)</span><br><span class="line"><span class="keyword">let</span> ctx = canvas.getContext(<span class="string">'2d'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> src = <span class="string">'https://mdn.mozillademos.org/files/222/Canvas_createpattern.png'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> img = <span class="keyword">new</span> Image()</span><br><span class="line"></span><br><span class="line">img.src = src</span><br><span class="line"></span><br><span class="line">img.onload = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> path = ctx.createPattern(img, <span class="string">'repeat'</span>)</span><br><span class="line">  <span class="comment">// 使用图片进行填充</span></span><br><span class="line">  ctx.fillStyle = path</span><br><span class="line">  ctx.fillRect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">150</span>, <span class="number">150</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="文本"><a href="#文本" class="headerlink" title="文本"></a>文本</h3><h4 id="fillText"><a href="#fillText" class="headerlink" title="fillText"></a>fillText</h4><p>绘制实心的文字, fillText(text, x, y)</p>
<h4 id="strokeText"><a href="#strokeText" class="headerlink" title="strokeText"></a>strokeText</h4><p>绘制描边的文字, strokeText(text, x, y)</p>
<h4 id="获取绘制文本的宽度"><a href="#获取绘制文本的宽度" class="headerlink" title="获取绘制文本的宽度"></a>获取绘制文本的宽度</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Rect = ctx.measureText(<span class="string">"foo"</span>)</span><br><span class="line"></span><br><span class="line">Rect.width</span><br></pre></td></tr></table></figure>
<h3 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h3><h4 id="drawImage"><a href="#drawImage" class="headerlink" title="drawImage"></a>drawImage</h4><blockquote>
<p>drawImage可以传递3个参数, 5个参数或者8个参数的形式。drawImage的第一个参数可以是一个Image对象或者是一个HTML的img标签，亦或者是另外一个canvas元素。</p>
</blockquote>
<p>⚠️ drawImage的使用需要注意跨域的问题, 如果遇到跨域的图片。需求前端和后端都做出对应的调整。解决方案如下</p>
<p><img src="https://i.loli.net/2019/01/27/5c4da4f295ede.png" alt="image"></p>
<h5 id="drawImage-image-x-y"><a href="#drawImage-image-x-y" class="headerlink" title="drawImage(image, x, y)"></a>drawImage(image, x, y)</h5><p>绘制图片不指定图片的宽高</p>
<h5 id="drawImage-image-x-y-w-h"><a href="#drawImage-image-x-y-w-h" class="headerlink" title="drawImage(image, x, y, w, h)"></a>drawImage(image, x, y, w, h)</h5><p>绘制图片同时指定图片的宽高</p>
<h5 id="drawImage-image-sx-sy-sWidth-sHeight-dx-dy-dWidth-dHeight"><a href="#drawImage-image-sx-sy-sWidth-sHeight-dx-dy-dWidth-dHeight" class="headerlink" title="drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight)"></a>drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight)</h5><p><img src="https://developer.mozilla.org/@api/deki/files/79/=Canvas_drawimage.jpg" alt="image"></p>
<p>sx, sy, sWidth, sHeight 是对原图切片位置和大小, <strong>从sx, sy位置切下sWidth, sHeight宽高的图片</strong></p>
<p>dx, dy, dWidth, dHeight 是切片后的图片的位置和大小, <strong>将切片放到dx, dy的位置, 宽高为dWidth和dHeight</strong></p>
<h3 id="变形"><a href="#变形" class="headerlink" title="变形"></a>变形</h3><blockquote>
<p>在作变形操作前保存状态是一个良好的习惯。一些变形操作会影响到canvas原有的坐标系统。通过save以及restore可以将原有的状态还原。</p>
</blockquote>
<h4 id="save"><a href="#save" class="headerlink" title="save"></a>save</h4><p>save方法将当前上下文的状态推送到栈中保存</p>
<h4 id="restore"><a href="#restore" class="headerlink" title="restore"></a>restore</h4><p>restore则是将上一个保存的状态取出, 恢复到上下文中</p>
<h4 id="translate"><a href="#translate" class="headerlink" title="translate"></a>translate</h4><p>translate可以改变canvas的原点的位置， translate(x, y)中的x, y为新的原点的位置。这在<strong>闪烁的星星的例子中有应用</strong>。(<em>translate可以避免一些原点偏移量的计算</em>)</p>
<h4 id="rotate"><a href="#rotate" class="headerlink" title="rotate"></a>rotate</h4><p><img src="https://developer.mozilla.org/@api/deki/files/84/=Canvas_grid_rotate.png" alt="image"></p>
<p>以中心点为圆心，对canvas的坐标系统进行偏转。rotate接受的参数是一个弧度的参数</p>
<h4 id="scale"><a href="#scale" class="headerlink" title="scale"></a>scale</h4><p>scale(x, y), x和y分别是x和y方向的缩放比例。”1”为不进行缩放和放大。</p>
<h3 id="合成裁剪"><a href="#合成裁剪" class="headerlink" title="合成裁剪"></a>合成裁剪</h3><h4 id="clip"><a href="#clip" class="headerlink" title="clip"></a>clip</h4><p>clip，<strong>将当前正在构建的路径转换为当前的裁剪路径</strong>。裁切后，绘图将会被限制在裁切的路径中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 这个圆形的路径就是clip的裁剪路径</span></span><br><span class="line">ctx.arc(<span class="number">0</span>, <span class="number">0</span>, <span class="number">80</span>, <span class="number">0</span>, <span class="built_in">Math</span>.PI*<span class="number">2</span>, <span class="literal">true</span>)</span><br><span class="line"></span><br><span class="line">ctx.clip()</span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2019/02/05/5c59975620b43.png" alt="image"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)</span><br><span class="line"><span class="keyword">let</span> ctx = canvas.getContext(<span class="string">'2d'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 画爱心</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">drawLove</span> (<span class="params">ctx</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> coloes = [</span><br><span class="line">    <span class="string">'#00bcd4'</span>,</span><br><span class="line">    <span class="string">'#039be5'</span>,</span><br><span class="line">    <span class="string">'#cddc39'</span>,</span><br><span class="line">    <span class="string">'#5c6bc0'</span>,</span><br><span class="line">    <span class="string">'#ec407a'</span></span><br><span class="line">  ]</span><br><span class="line">  ctx.save()</span><br><span class="line">  ctx.beginPath()</span><br><span class="line">  ctx.globalAlpha = <span class="number">0.3</span></span><br><span class="line">  ctx.fillStyle = coloes[<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">5</span>)]</span><br><span class="line">  ctx.moveTo(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">  ctx.bezierCurveTo(<span class="number">-30</span>, <span class="number">-10</span>, <span class="number">-20</span>, <span class="number">30</span>, <span class="number">0</span>, <span class="number">30</span>)</span><br><span class="line">  ctx.bezierCurveTo(<span class="number">20</span>, <span class="number">30</span>, <span class="number">30</span>, <span class="number">-10</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">  ctx.fill()</span><br><span class="line">  ctx.restore()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ctx.save()</span><br><span class="line"></span><br><span class="line">ctx.fillRect(<span class="number">0</span>, <span class="number">0</span>, <span class="number">200</span>, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line">ctx.beginPath()</span><br><span class="line"></span><br><span class="line">ctx.translate(<span class="number">100</span>, <span class="number">100</span>)</span><br><span class="line"><span class="comment">// 裁切的路径</span></span><br><span class="line">ctx.arc(</span><br><span class="line">  <span class="number">0</span>,</span><br><span class="line">  <span class="number">0</span>,</span><br><span class="line">  <span class="number">80</span>,</span><br><span class="line">  <span class="number">0</span>,</span><br><span class="line">  (<span class="built_in">Math</span>.PI/<span class="number">180</span>) * <span class="number">360</span>,</span><br><span class="line">  <span class="literal">true</span></span><br><span class="line">)</span><br><span class="line">ctx.clip()</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> lingrad = ctx.createLinearGradient(<span class="number">0</span>, <span class="number">-100</span> ,<span class="number">0</span>, <span class="number">100</span>)</span><br><span class="line">lingrad.addColorStop(<span class="number">0</span>, <span class="string">'#232256'</span>)</span><br><span class="line">lingrad.addColorStop(<span class="number">1</span>, <span class="string">'#143778'</span>)</span><br><span class="line">ctx.fillStyle = lingrad</span><br><span class="line">ctx.fillRect(<span class="number">-100</span>, <span class="number">-100</span>, <span class="number">200</span>, <span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">80</span>; i++) &#123;</span><br><span class="line">  ctx.save()</span><br><span class="line">  <span class="comment">// 随机开始绘画的点</span></span><br><span class="line">  <span class="comment">// 使用translate可以避免一些没有必要的偏移量计算</span></span><br><span class="line">  ctx.translate(</span><br><span class="line">    <span class="number">75</span>-<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*<span class="number">150</span>),</span><br><span class="line">    <span class="number">75</span>-<span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random()*<span class="number">150</span>)</span><br><span class="line">  );</span><br><span class="line">  drawLove(ctx)</span><br><span class="line">  ctx.restore()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="基本动画"><a href="#基本动画" class="headerlink" title="基本动画"></a>基本动画</h3><p>canvas中的动画的原理类似与小人书, 依赖的是每一帧画面之间的拼接。大致过程为以下4个步骤:</p>
<ol>
<li>绘制当前帧</li>
<li>清空Canvas</li>
<li>绘制下一帧</li>
</ol>
<p>…</p>
<h4 id="操控动画"><a href="#操控动画" class="headerlink" title="操控动画"></a>操控动画</h4><p>可以使用setTimeout或者setInterval，更推荐使用window.requestAnimationFrame，window.requestAnimationFrame实现的动画更加平滑。</p>
<h4 id="canvas画一个时钟"><a href="#canvas画一个时钟" class="headerlink" title="canvas画一个时钟"></a>canvas画一个时钟</h4><p><img src="https://i.loli.net/2019/02/06/5c59b8ca284ca.png" alt="image"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>)</span><br><span class="line"><span class="keyword">let</span> ctx = canvas.getContext(<span class="string">'2d'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> width = <span class="built_in">parseInt</span>(canvas.getAttribute(<span class="string">'width'</span>).replace(<span class="regexp">/px/</span>, <span class="string">''</span>), <span class="number">10</span>)</span><br><span class="line"><span class="keyword">let</span> height = <span class="built_in">parseInt</span>(canvas.getAttribute(<span class="string">'height'</span>).replace(<span class="regexp">/px/</span>, <span class="string">''</span>), <span class="number">10</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hourhand</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span> (ctx) &#123;</span><br><span class="line">    <span class="keyword">this</span>.ctx = ctx</span><br><span class="line">    <span class="keyword">this</span>.date = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  draw () &#123;</span><br><span class="line">    <span class="keyword">this</span>.date = <span class="keyword">new</span> <span class="built_in">Date</span>()</span><br><span class="line">    ctx.clearRect(<span class="number">0</span>, <span class="number">0</span>, width, height)</span><br><span class="line">    <span class="keyword">this</span>.drawDial()</span><br><span class="line">    <span class="keyword">this</span>.drawScale()</span><br><span class="line">    <span class="keyword">this</span>.drawSecond()</span><br><span class="line">    <span class="keyword">this</span>.drawMinute()</span><br><span class="line">    <span class="keyword">this</span>.drawHour()</span><br><span class="line">    <span class="built_in">window</span>.requestAnimationFrame(<span class="keyword">this</span>.draw.bind(<span class="keyword">this</span>))</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 画一个表盘</span></span><br><span class="line">  drawDial () &#123;</span><br><span class="line">    ctx.save()</span><br><span class="line">    ctx.beginPath()</span><br><span class="line">    ctx.translate(<span class="number">150</span>, <span class="number">150</span>)</span><br><span class="line">    ctx.lineWidth = <span class="number">5</span></span><br><span class="line">    ctx.strokeStyle = <span class="string">'#304ffe'</span></span><br><span class="line">    ctx.arc(<span class="number">0</span>, <span class="number">0</span>, <span class="number">100</span>, <span class="number">0</span>, (<span class="built_in">Math</span>.PI/<span class="number">180</span>) * <span class="number">360</span>, <span class="literal">true</span>)</span><br><span class="line">    ctx.closePath()</span><br><span class="line">    ctx.stroke()</span><br><span class="line">    ctx.restore()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 画刻度</span></span><br><span class="line">  drawScale () &#123;</span><br><span class="line">    <span class="keyword">const</span> drawSecondPoint = <span class="function">(<span class="params">i</span>) =&gt;</span> &#123;</span><br><span class="line">      ctx.save()</span><br><span class="line">      ctx.beginPath()</span><br><span class="line">      ctx.translate(<span class="number">150</span>, <span class="number">150</span>)</span><br><span class="line">      ctx.lineWidth = <span class="number">2</span></span><br><span class="line">      <span class="keyword">if</span> (i % <span class="number">5</span> === <span class="number">0</span>) ctx.lineWidth = <span class="number">6</span></span><br><span class="line">      ctx.strokeStyle = <span class="string">'#009688'</span></span><br><span class="line">      ctx.rotate((<span class="built_in">Math</span>.PI/<span class="number">180</span>) * i * <span class="number">6</span>)</span><br><span class="line">      <span class="keyword">if</span> (i % <span class="number">5</span> === <span class="number">0</span>) &#123;</span><br><span class="line">        ctx.moveTo(<span class="number">0</span>, <span class="number">-85</span>)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ctx.moveTo(<span class="number">0</span>, <span class="number">-90</span>)</span><br><span class="line">      &#125;</span><br><span class="line">      ctx.lineTo(<span class="number">0</span>, <span class="number">-98</span>)</span><br><span class="line">      ctx.closePath()</span><br><span class="line">      ctx.stroke()</span><br><span class="line">      ctx.restore()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">60</span>; i++) &#123;</span><br><span class="line">      drawSecondPoint(i)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="comment">// 画时针</span></span><br><span class="line">  drawSecond () &#123;</span><br><span class="line">    <span class="keyword">let</span> second = <span class="keyword">this</span>.date.getSeconds()</span><br><span class="line">    ctx.save()</span><br><span class="line">    ctx.beginPath()</span><br><span class="line">    ctx.translate(<span class="number">150</span>, <span class="number">150</span>)</span><br><span class="line">    ctx.lineWidth = <span class="number">2</span></span><br><span class="line">    ctx.strokeStyle = <span class="string">'#e65100'</span></span><br><span class="line">    ctx.rotate((<span class="built_in">Math</span>.PI/<span class="number">180</span>) * second * <span class="number">6</span>)</span><br><span class="line">    ctx.moveTo(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    ctx.lineTo(<span class="number">0</span>, <span class="number">-80</span>)</span><br><span class="line">    ctx.closePath()</span><br><span class="line">    ctx.stroke()</span><br><span class="line">    ctx.restore()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 画分针</span></span><br><span class="line">  drawMinute () &#123;</span><br><span class="line">    <span class="keyword">let</span> minute = <span class="keyword">this</span>.date.getMinutes()</span><br><span class="line">    ctx.save()</span><br><span class="line">    ctx.beginPath()</span><br><span class="line">    ctx.translate(<span class="number">150</span>, <span class="number">150</span>)</span><br><span class="line">    ctx.lineWidth = <span class="number">8</span></span><br><span class="line">    ctx.strokeStyle = <span class="string">'#1b5e20'</span></span><br><span class="line">    ctx.rotate((<span class="built_in">Math</span>.PI/<span class="number">180</span>) * minute * <span class="number">6</span>)</span><br><span class="line">    ctx.moveTo(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    ctx.lineTo(<span class="number">0</span>, <span class="number">-50</span>)</span><br><span class="line">    ctx.closePath()</span><br><span class="line">    ctx.stroke()</span><br><span class="line">    ctx.restore()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 画秒针</span></span><br><span class="line">  drawHour () &#123;</span><br><span class="line">    <span class="keyword">let</span> hour = <span class="keyword">this</span>.date.getHours()</span><br><span class="line">    hour = hour &lt; hour ? hour : hour - <span class="number">12</span></span><br><span class="line">    ctx.save()</span><br><span class="line">    ctx.beginPath()</span><br><span class="line">    ctx.translate(<span class="number">150</span>, <span class="number">150</span>)</span><br><span class="line">    ctx.lineWidth = <span class="number">8</span></span><br><span class="line">    ctx.strokeStyle = <span class="string">'#0091ea'</span></span><br><span class="line">    ctx.rotate((<span class="built_in">Math</span>.PI/<span class="number">180</span>) * hour * <span class="number">30</span>)</span><br><span class="line">    ctx.moveTo(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    ctx.lineTo(<span class="number">0</span>, <span class="number">-25</span>)</span><br><span class="line">    ctx.closePath()</span><br><span class="line">    ctx.stroke()</span><br><span class="line">    ctx.restore()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> hourhand = <span class="keyword">new</span> Hourhand(ctx, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">window</span>.requestAnimationFrame(hourhand.draw.bind(hourhand))</span><br></pre></td></tr></table></figure>
<h3 id="高级动画"><a href="#高级动画" class="headerlink" title="高级动画"></a>高级动画</h3><h4 id="常用的技巧"><a href="#常用的技巧" class="headerlink" title="常用的技巧"></a>常用的技巧</h4><ol>
<li>速度乘与一个小数, 可以实现逐渐减速的效果</li>
<li>速度乘与一个小数, 其中一个方向比如Y方向同时加上一个速度可以实现类似抛物线的运动轨迹</li>
<li>长尾效果，不使用clearRect清除前一祯的动画，使用半透明fillRect替代可以实现长尾效果</li>
</ol>
<h3 id="像素操作"><a href="#像素操作" class="headerlink" title="像素操作"></a>像素操作</h3><h4 id="ImageData"><a href="#ImageData" class="headerlink" title="ImageData"></a>ImageData</h4><p>ImageData存储着Canvas的像素信息</p>
<ol>
<li>ImageData.width 宽度</li>
<li>ImageData.height 高度</li>
<li>ImageData.data 像素的数组, Uint8ClampedArray, (每个像素用4个1bytes值, 所以一个像素大约占用4比特的内存)。像素包含4种颜色信息, rgb三种颜色, 已经透明度。</li>
</ol>
<p>获取对应行, 对应列的像素消息公司如下:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 读取像素点的红色信息</span></span><br><span class="line">imageData.data[((行数<span class="number">-1</span>)*imageData.width + (列数<span class="number">-1</span>))*<span class="number">4</span> - <span class="number">1</span> + <span class="number">1</span>]</span><br><span class="line"><span class="comment">// 读取像素点的绿色信息</span></span><br><span class="line">imageData.data[((行数<span class="number">-1</span>)*imageData.width + (列数<span class="number">-1</span>))*<span class="number">4</span> - <span class="number">1</span> + <span class="number">2</span>]</span><br><span class="line"><span class="comment">// 读取像素点的蓝色信息</span></span><br><span class="line">imageData.data[((行数<span class="number">-1</span>)*imageData.width + (列数<span class="number">-1</span>))*<span class="number">4</span> - <span class="number">1</span> + <span class="number">3</span>]</span><br><span class="line"><span class="comment">// 读取像素点的透明信息</span></span><br><span class="line">imageData.data[((行数<span class="number">-1</span>)*imageData.width + (列数<span class="number">-1</span>))*<span class="number">4</span> - <span class="number">1</span> + <span class="number">4</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取图片中位于第50行，第200列的像素的蓝色部份</span></span><br><span class="line">blueComponent = imageData.data[((<span class="number">50</span><span class="number">-1</span>)*imageData.width + (<span class="number">200</span><span class="number">-1</span>))*<span class="number">4</span> - <span class="number">1</span> + <span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<h4 id="创建一个ImageData对象"><a href="#创建一个ImageData对象" class="headerlink" title="创建一个ImageData对象"></a>创建一个ImageData对象</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 获取画布的像素信息</span></span><br><span class="line"><span class="comment">// left, top 起始点的坐标</span></span><br><span class="line"><span class="comment">// width 宽 height 高</span></span><br><span class="line"><span class="keyword">var</span> myImageData = ctx.getImageData(left, top, width, height)</span><br></pre></td></tr></table></figure>
<h4 id="putImageData"><a href="#putImageData" class="headerlink" title="putImageData"></a>putImageData</h4><p>putImageData(data, x, y), 将像素消息渲染到上下文从x, y坐标开始</p>
<h4 id="保存图片"><a href="#保存图片" class="headerlink" title="保存图片"></a>保存图片</h4><h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><ol>
<li>避免浮点数坐标</li>
<li>离屏渲染（在内存中的canvas对象渲染好图像，使用drawImage渲染到dom中的canvas，drawImage可以将canvas渲染到canvas上）</li>
<li>使用多层画布画一个复杂场景（不经常改变的元素可以使用另一层画布渲染）</li>
<li>使用css渲染背景图，避免重复的渲染背景图</li>
<li>不要在用drawImage时缩放图像</li>
</ol>
<h2 id="效果-粒子碰撞"><a href="#效果-粒子碰撞" class="headerlink" title="效果 - 粒子碰撞"></a>效果 - 粒子碰撞</h2><h3 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h3><p><img src="https://i.loli.net/2019/02/06/5c59bde2e07a9.png" alt="image"></p>
<p><a href="http://canvas.bengbuzhangyue.xyz/ballline/dist/" target="_blank" rel="noopener">预览地址</a></p>
<p><a href="https://github.com/BengBu-YueZhang/learn-canvas/blob/03_ball_line/index.js" target="_blank" rel="noopener">源码地址</a></p>
<h3 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h3><p>所谓的粒子，既是使用ctx.arc绘制的一连串小球</p>
<p>初始化小球后, 他们的运动方向即(vx, vy)的速度是完全随机的</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">let</span> xDirection = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> yDirection = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">2</span>)</span><br><span class="line"><span class="keyword">let</span> x = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * width)</span><br><span class="line"><span class="keyword">let</span> y = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * height)</span><br><span class="line"><span class="comment">// -3 ～ 3 的随机速度</span></span><br><span class="line"><span class="keyword">let</span> vx = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">3</span> + <span class="number">1</span>)</span><br><span class="line"><span class="keyword">let</span> vy = <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">3</span> + <span class="number">1</span>)</span><br><span class="line">vx = xDirection === <span class="number">1</span> ? vx : -vx</span><br><span class="line">vy = yDirection === <span class="number">1</span> ? vy : -vy</span><br><span class="line"><span class="keyword">let</span> ball = <span class="keyword">new</span> Ball(x, y, vx, vy, i)</span><br><span class="line">balls.push(ball)</span><br></pre></td></tr></table></figure>
<p>小球在碰撞到屏幕边界后会有对应的碰撞检测</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.x &gt;= width - <span class="keyword">this</span>.size || <span class="keyword">this</span>.x &lt;= <span class="number">0</span> + <span class="keyword">this</span>.size) &#123;</span><br><span class="line">  <span class="keyword">this</span>.vx = -<span class="keyword">this</span>.vx</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">this</span>.y &gt;= height - <span class="keyword">this</span>.size || <span class="keyword">this</span>.y &lt;= <span class="number">0</span> + <span class="keyword">this</span>.size) &#123;</span><br><span class="line">  <span class="keyword">this</span>.vy = -<span class="keyword">this</span>.vy</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">this</span>.x += <span class="keyword">this</span>.vx</span><br><span class="line"><span class="keyword">this</span>.y += <span class="keyword">this</span>.vy</span><br></pre></td></tr></table></figure>
<p>在重绘每一帧之前，通过勾股定理计算每一个小球之前的距离，如果距离小于一定的阀值那么绘制两个小球之间的连线</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; balls.length; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span> (i === <span class="keyword">this</span>.index) &#123;</span><br><span class="line">    <span class="comment">// 排除自身</span></span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> diffx = <span class="built_in">Math</span>.abs(<span class="keyword">this</span>.x - balls[i].x)</span><br><span class="line">    <span class="keyword">let</span> diffy = <span class="built_in">Math</span>.abs(<span class="keyword">this</span>.y - balls[i].y)</span><br><span class="line">    <span class="keyword">let</span> diffs = <span class="built_in">Math</span>.sqrt((diffx * diffx) + (diffy * diffy))</span><br><span class="line">    <span class="keyword">if</span> (diffs &lt;= <span class="number">200</span> ) &#123;</span><br><span class="line">      ctx.strokeStyle = <span class="string">`rgba(189, 189, 189, <span class="subst">$&#123;diffs <span class="regexp">/ 200&#125;)`</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">      ctx.moveTo(this.x, this.y)</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">      ctx.lineTo(balls[i].x, balls[i].y)</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">      ctx.stroke()</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">    &#125;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">  &#125;</span></span></span></span><br><span class="line"><span class="string"><span class="subst"><span class="regexp">&#125;</span></span></span></span><br></pre></td></tr></table></figure>
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/canvas/" rel="tag"># canvas</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/01/31/mood2019131/" rel="next" title="2019.1.31 心情小记">
                <i class="fa fa-chevron-left"></i> 2019.1.31 心情小记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/03/07/SVG/" rel="prev" title="SVG">
                SVG <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpeg"
                alt="张越" />
            
              <p class="site-author-name" itemprop="name">张越</p>
              <p class="site-description motion-element" itemprop="description">所谓成长，就是经过不断的聚散离合，找到不太会伤害到彼此的距离</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">82</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">35</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/BengBu-YueZhang" target="_blank" title="我的GitHub">
                      
                        <i class="fa fa-fw fa-globe"></i>我的GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://weibo.com/5460100952/profile?topnav=1&wvr=6" target="_blank" title="我的微博">
                      
                        <i class="fa fa-fw fa-globe"></i>我的微博</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基础API"><span class="nav-number">2.</span> <span class="nav-text">基础API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#形状-线条"><span class="nav-number">2.1.</span> <span class="nav-text">形状, 线条</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#形状"><span class="nav-number">2.1.1.</span> <span class="nav-text">形状</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#fillRect"><span class="nav-number">2.1.1.1.</span> <span class="nav-text">fillRect</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#strokeRect"><span class="nav-number">2.1.1.2.</span> <span class="nav-text">strokeRect</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#clearRect"><span class="nav-number">2.1.1.3.</span> <span class="nav-text">clearRect</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#路径"><span class="nav-number">2.1.2.</span> <span class="nav-text">路径</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#beginPath"><span class="nav-number">2.1.2.1.</span> <span class="nav-text">beginPath</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#moveTo"><span class="nav-number">2.1.2.2.</span> <span class="nav-text">moveTo</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#lineTo"><span class="nav-number">2.1.2.3.</span> <span class="nav-text">lineTo</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#closePath"><span class="nav-number">2.1.2.4.</span> <span class="nav-text">closePath</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#fill"><span class="nav-number">2.1.2.5.</span> <span class="nav-text">fill</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#stroke"><span class="nav-number">2.1.2.6.</span> <span class="nav-text">stroke</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#arc"><span class="nav-number">2.1.2.7.</span> <span class="nav-text">arc</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#quadraticCurveTo-二次贝塞尔曲线"><span class="nav-number">2.1.2.8.</span> <span class="nav-text">quadraticCurveTo 二次贝塞尔曲线</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#bezierCurveTo-三次贝塞尔曲线"><span class="nav-number">2.1.2.9.</span> <span class="nav-text">bezierCurveTo 三次贝塞尔曲线</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Path2D"><span class="nav-number">2.1.2.10.</span> <span class="nav-text">Path2D</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#颜色样式"><span class="nav-number">2.2.</span> <span class="nav-text">颜色样式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#颜色"><span class="nav-number">2.2.1.</span> <span class="nav-text">颜色</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#fillStyle"><span class="nav-number">2.2.1.1.</span> <span class="nav-text">fillStyle</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#strokeStyle"><span class="nav-number">2.2.1.2.</span> <span class="nav-text">strokeStyle</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#透明度"><span class="nav-number">2.2.2.</span> <span class="nav-text">透明度</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#线条样式"><span class="nav-number">2.2.3.</span> <span class="nav-text">线条样式</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#lineWidth"><span class="nav-number">2.2.3.1.</span> <span class="nav-text">lineWidth</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#lineCap"><span class="nav-number">2.2.3.2.</span> <span class="nav-text">lineCap</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#渐变色"><span class="nav-number">2.2.4.</span> <span class="nav-text">渐变色</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#线性渐变-createLinearGradient"><span class="nav-number">2.2.4.1.</span> <span class="nav-text">线性渐变 createLinearGradient</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#addColorStop"><span class="nav-number">2.2.4.2.</span> <span class="nav-text">addColorStop</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#径向渐变-createRadialGradient"><span class="nav-number">2.2.4.3.</span> <span class="nav-text">径向渐变 createRadialGradient</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#阴影"><span class="nav-number">2.2.5.</span> <span class="nav-text">阴影</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#shadowOffsetX"><span class="nav-number">2.2.5.1.</span> <span class="nav-text">shadowOffsetX</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#shadowOffsetY"><span class="nav-number">2.2.5.2.</span> <span class="nav-text">shadowOffsetY</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#shadowColor"><span class="nav-number">2.2.5.3.</span> <span class="nav-text">shadowColor</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#shadowBlur"><span class="nav-number">2.2.5.4.</span> <span class="nav-text">shadowBlur</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Patterns-图片填充"><span class="nav-number">2.2.6.</span> <span class="nav-text">Patterns 图片填充</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#文本"><span class="nav-number">2.3.</span> <span class="nav-text">文本</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#fillText"><span class="nav-number">2.3.1.</span> <span class="nav-text">fillText</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#strokeText"><span class="nav-number">2.3.2.</span> <span class="nav-text">strokeText</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#获取绘制文本的宽度"><span class="nav-number">2.3.3.</span> <span class="nav-text">获取绘制文本的宽度</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图片"><span class="nav-number">2.4.</span> <span class="nav-text">图片</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#drawImage"><span class="nav-number">2.4.1.</span> <span class="nav-text">drawImage</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#drawImage-image-x-y"><span class="nav-number">2.4.1.1.</span> <span class="nav-text">drawImage(image, x, y)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#drawImage-image-x-y-w-h"><span class="nav-number">2.4.1.2.</span> <span class="nav-text">drawImage(image, x, y, w, h)</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#drawImage-image-sx-sy-sWidth-sHeight-dx-dy-dWidth-dHeight"><span class="nav-number">2.4.1.3.</span> <span class="nav-text">drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight)</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#变形"><span class="nav-number">2.5.</span> <span class="nav-text">变形</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#save"><span class="nav-number">2.5.1.</span> <span class="nav-text">save</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#restore"><span class="nav-number">2.5.2.</span> <span class="nav-text">restore</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#translate"><span class="nav-number">2.5.3.</span> <span class="nav-text">translate</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rotate"><span class="nav-number">2.5.4.</span> <span class="nav-text">rotate</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#scale"><span class="nav-number">2.5.5.</span> <span class="nav-text">scale</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#合成裁剪"><span class="nav-number">2.6.</span> <span class="nav-text">合成裁剪</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#clip"><span class="nav-number">2.6.1.</span> <span class="nav-text">clip</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本动画"><span class="nav-number">2.7.</span> <span class="nav-text">基本动画</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#操控动画"><span class="nav-number">2.7.1.</span> <span class="nav-text">操控动画</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#canvas画一个时钟"><span class="nav-number">2.7.2.</span> <span class="nav-text">canvas画一个时钟</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#高级动画"><span class="nav-number">2.8.</span> <span class="nav-text">高级动画</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#常用的技巧"><span class="nav-number">2.8.1.</span> <span class="nav-text">常用的技巧</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#像素操作"><span class="nav-number">2.9.</span> <span class="nav-text">像素操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ImageData"><span class="nav-number">2.9.1.</span> <span class="nav-text">ImageData</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#创建一个ImageData对象"><span class="nav-number">2.9.2.</span> <span class="nav-text">创建一个ImageData对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#putImageData"><span class="nav-number">2.9.3.</span> <span class="nav-text">putImageData</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#保存图片"><span class="nav-number">2.9.4.</span> <span class="nav-text">保存图片</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#优化"><span class="nav-number">2.10.</span> <span class="nav-text">优化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#效果-粒子碰撞"><span class="nav-number">3.</span> <span class="nav-text">效果 - 粒子碰撞</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#效果预览"><span class="nav-number">3.1.</span> <span class="nav-text">效果预览</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#思路"><span class="nav-number">3.2.</span> <span class="nav-text">思路</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">张越</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
